import{d as f,k as E,q as w,l as U,c as V,w as x,B as I,o as F,a as u,e as P,b,f as B,j as k,v as N,u as G,N as M}from"./app-DIsI2h6N.js";import{_ as O}from"./AdminPanel-4mme3aov.js";import{_ as L}from"./Main-BuhnLEuc.js";import{_ as j}from"./MultiSelectDropdown-B9XsDNK4.js";import{T as $}from"./TableContainer-BvhjGUIg.js";import{P as D,D as Q}from"./dataTables-CYg83-KT.js";import"./buttons.print-0974EdRm.js";import{E as W}from"./exceljs.min-BCSGA5zn.js";import"./RetailGroup-g15s03XT.js";import"./Logout-CSswU4gJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-DKCN2m9N.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-BHRlHpU4.js";import"./RetailItems-BxtVv693.js";import"./PartyCake143-D_7hneaj.js";const J={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},z={key:0,class:"flex-1 min-w-[200px]"},H={class:"flex-1 min-w-[200px]"},K={class:"flex-1 min-w-[200px]"},X={class:"flex items-end"},Y={class:"h-full w-full"},yt={__name:"TSales copy",props:{ar:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(_){D.use(Q);const m=f([]),i=f(""),d=f(""),n=_;E(()=>{m.value=n.filters.selectedStores||[],i.value=n.filters.startDate||"",d.value=n.filters.endDate||""});const R=w(()=>(console.log("userRole value:",n.userRole),console.log("Is Store?:",n.userRole.toUpperCase()==="STORE"),n.userRole.toUpperCase()==="STORE"?L:O)),c=w(()=>n.ar.reduce((t,o)=>{const s=Number(o.total_netamount||0),r=Number(o.total_discamount||0),y=Number(o.total_grossamount||0),e=Number(o.total_costamount||0),l=Number(o.total_costprice||0),v=Number(o.price||0),p=Number(o.qty||0),q=Number(o.vatablesales||0),A=Number(o.vat||0);return{total_netamount:parseFloat((t.total_netamount+s).toFixed(2)),total_discamount:parseFloat((t.total_discamount+r).toFixed(2)),total_grossamount:parseFloat((t.total_grossamount+y).toFixed(2)),total_costamount:parseFloat((t.total_costamount+e).toFixed(2)),total_costprice:parseFloat((t.total_costprice+l).toFixed(2)),total_price:parseFloat((t.total_price+v).toFixed(2)),total_qty:parseFloat((t.total_qty+p).toFixed(2)),total_vatablesales:parseFloat((t.total_vatablesales+q).toFixed(2)),total_vat:parseFloat((t.total_vat+A).toFixed(2))}},{total_netamount:0,total_discamount:0,total_grossamount:0,total_costamount:0,total_costprice:0,total_price:0,total_qty:0,total_vatablesales:0,total_vat:0})),h=()=>{if(i.value&&d.value&&new Date(i.value)>new Date(d.value)){alert("Start date cannot be later than end date"),i.value="",d.value="";return}const t={startDate:i.value||null,endDate:d.value||null,stores:m.value.length>0?m.value:null};M.get(route("reports.tsales"),t,{preserveState:!0,preserveScroll:!0})};let g;U([m,i,d],()=>{clearTimeout(g),g=setTimeout(h,500)},{deep:!0});const a=t=>`â‚±${parseFloat(t).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,S=[{data:"store",title:"Store",footer:"Grand Total"},{data:"staff",title:"Staff"},{data:"dateonly",title:"Date"},{data:"timeonly",title:"Time"},{data:"transactionid",title:"Transaction ID"},{data:"receiptid",title:"Receipt ID"},{data:"paymentmethod",title:"Payment Method"},{data:"custaccount",title:"Customer"},{data:"itemname",title:"Item Name"},{data:"itemgroup",title:"Item Group"},{data:"price",title:"Price",render:t=>a(t??0)},{data:"qty",title:"Quantity",render:t=>t??0},{data:"total_costprice",title:"Cost Price",render:t=>a(t??0),footer:a(c.value.total_costprice??0)},{data:"total_grossamount",title:"Gross Amount",render:t=>a(t??0),footer:a(c.value.total_grossamount??0)},{data:"total_costamount",title:"Cost Amount",render:t=>a(t??0),footer:a(c.value.total_costamount??0)},{data:"total_discamount",title:"Discount Amount",render:t=>a(t??0),footer:a(c.value.total_discamount??0)},{data:"total_netamount",title:"Net Amount",render:t=>a(t??0),footer:a(c.value.total_netamount??0)},{data:"vatablesales",title:"Vatable Sales",render:t=>a(t??0),footer:a(c.value.vatablesales??0)},{data:"vat",title:"VAT",render:t=>a(t??0),footer:a(c.value.vat??0)}],C={responsive:!0,dom:"lBfrtip",scrollCollapse:!0,buttons:["copy",{text:"Export Excel",action:(t,o,s,r)=>T()},"pdf","print"],order:[[0,"asc"]]},T=()=>{const t=new W.Workbook,o=t.addWorksheet("Sales Report");o.columns=[{header:"Store",key:"store",width:20},{header:"Staff",key:"staff",width:15},{header:"Date",key:"dateonly",width:12},{header:"Time",key:"timeonly",width:10},{header:"Transaction ID",key:"transactionid",width:15},{header:"Receipt ID",key:"receiptid",width:15},{header:"Payment Method",key:"paymentmethod",width:15},{header:"Customer",key:"custaccount",width:15},{header:"Item Name",key:"itemname",width:30},{header:"Item Group",key:"itemgroup",width:15},{header:"Price",key:"price",width:12,style:{numFmt:"#,##0.00"}},{header:"Quantity",key:"qty",width:10,style:{numFmt:"#,##0"}},{header:"Cost Price",key:"total_costprice",width:12,style:{numFmt:"#,##0.00"}},{header:"Gross Amount",key:"total_grossamount",width:12,style:{numFmt:"#,##0.00"}},{header:"Cost Amount",key:"total_costamount",width:12,style:{numFmt:"#,##0.00"}},{header:"Discount Amount",key:"total_discamount",width:12,style:{numFmt:"#,##0.00"}},{header:"Net Amount",key:"total_netamount",width:12,style:{numFmt:"#,##0.00"}},{header:"Vatable Sales",key:"vatablesales",width:12,style:{numFmt:"#,##0.00"}},{header:"VAT",key:"vat",width:12,style:{numFmt:"#,##0.00"}}];const s=o.getRow(1);s.font={bold:!0},s.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE0E0E0"}},n.ar.forEach(e=>{o.addRow({store:e.store||"",staff:e.staff||"",dateonly:e.dateonly||"",timeonly:e.timeonly||"",transactionid:e.transactionid||"",receiptid:e.receiptid||"",paymentmethod:e.paymentmethod||"",itemname:e.itemname||"",itemgroup:e.itemgroup||"",price:Number(e.price)||0,qty:Number(e.qty)||0,total_costprice:Number(e.total_costprice)||0,total_grossamount:Number(e.total_grossamount)||0,total_costamount:Number(e.total_costamount)||0,total_discamount:Number(e.total_discamount)||0,total_netamount:Number(e.total_netamount)||0,vatablesales:Number(e.vatablesales)||0,vat:Number(e.vat)||0})});const r=n.ar.reduce((e,l)=>({qty:e.qty+(Number(l.qty)||0),total_costprice:e.total_costprice+(Number(l.total_costprice)||0),total_grossamount:e.total_grossamount+(Number(l.total_grossamount)||0),total_costamount:e.total_costamount+(Number(l.total_costamount)||0),total_discamount:e.total_discamount+(Number(l.total_discamount)||0),total_netamount:e.total_netamount+(Number(l.total_netamount)||0),vatablesales:e.vatablesales+(Number(l.vatablesales)||0),vat:e.vat+(Number(l.vat)||0)}),{qty:0,total_costprice:0,total_grossamount:0,total_costamount:0,total_discamount:0,total_netamount:0,vatablesales:0,vat:0}),y=o.addRow({store:"Grand Total",qty:r.qty,total_costprice:r.total_costprice,total_grossamount:r.total_grossamount,total_costamount:r.total_costamount,total_discamount:r.total_discamount,total_netamount:r.total_netamount,vatablesales:r.vatablesales,vat:r.vat});y.font={bold:!0},y.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF0F0F0"}},o.eachRow(e=>{e.eachCell(l=>{l.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}}})}),t.xlsx.writeBuffer().then(e=>{const l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),v=window.URL.createObjectURL(l),p=document.createElement("a");p.href=v,p.download="transactions.xlsx",p.click(),window.URL.revokeObjectURL(v)})};return(t,o)=>(F(),V(I(R.value),{"active-tab":"REPORTS"},{main:x(()=>[u("div",J,[_.userRole.toUpperCase()==="ADMIN"||_.userRole.toUpperCase()==="SUPERADMIN"?(F(),P("div",z,[b(j,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),options:_.stores,label:"Stores"},null,8,["modelValue","options"])])):B("",!0),u("div",H,[o[4]||(o[4]=u("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),k(u("input",{type:"date","onUpdate:modelValue":o[1]||(o[1]=s=>i.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[N,i.value]])]),u("div",K,[o[5]||(o[5]=u("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),k(u("input",{type:"date","onUpdate:modelValue":o[2]||(o[2]=s=>d.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[N,d.value]])]),u("div",X,[u("button",{onClick:o[3]||(o[3]=()=>{m.value.value=[],i.value.value="",d.value.value="",h()}),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),u("div",Y,[b($,{class:"overflow-auto"},{default:x(()=>[b(G(D),{data:n.ar,columns:S,class:"min-w-full",options:C},null,8,["data"])]),_:1})])]),_:1}))}};export{yt as default};
