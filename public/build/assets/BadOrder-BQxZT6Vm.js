import{d as m,k as A,q as _,l as E,E as S,c as R,w as x,o as b,a as e,e as C,b as c,f as B,j as v,v as w,t as i,u as M,N as O}from"./app-CacuESpm.js";import{_ as k}from"./Main-2jZhlWuC.js";import{_ as U}from"./MultiSelectDropdown-DQa9I4Ez.js";import{T as I}from"./TableContainer-D6l808Wc.js";import{P as y,D as N}from"./dataTables-BnFpA0RH.js";import"./Logout-CqgzcP31.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-CTDQd9c8.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-Oe7tEmQB.js";import"./PartyCake143-Di4gRlu7.js";import"./Attendance-B0jvDPeG.js";const L={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},V={key:0,class:"flex-1 min-w-[200px]"},P={class:"flex-1 min-w-[200px]"},q={class:"flex-1 min-w-[200px]"},Y={class:"collapse collapse-plus bg-gray-100 rounded-none"},W={class:"collapse-content"},j={class:"mb-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},H={class:"bg-white p-4 rounded-lg shadow"},$={class:"mt-1 text-lg font-semibold"},G={class:"bg-white p-4 rounded-lg shadow"},X={class:"mt-1 text-lg font-semibold"},z={class:"bg-white p-4 rounded-lg shadow"},J={class:"mt-1 text-lg font-semibold"},K={class:"bg-white p-4 rounded-lg shadow"},Q={class:"mt-1 text-lg font-semibold"},Z={class:"bg-white p-4 rounded-lg shadow"},tt={class:"mt-1 text-lg font-semibold"},et={class:"bg-white p-4 rounded-lg shadow"},at={class:"mt-1 text-lg font-semibold text-red-600"},gt={__name:"BadOrder",props:{bo:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(n){y.use(N);const l=m([]),o=m(""),s=m(""),u=n;A(()=>{l.value=u.filters.selectedStores||[],o.value=u.filters.startDate||"",s.value=u.filters.endDate||""});const f=_(()=>u.bo),h=[{data:"storename",title:"STORE"},{data:"itemid",title:"ITEM ID"},{data:"itemname",title:"ITEM NAME"},{data:"category",title:"CATEGORY"},{data:"batchdate",title:"BATCH DATE",render:function(a,t,r){return a?new Date(a).toLocaleDateString():""}},{data:"waste_declaration_date",title:"WASTE DATE",render:function(a,t,r){return a?new Date(a).toLocaleDateString():""}},{data:"price",title:"PRICE",render:function(a){return"₱"+parseFloat(a||0).toFixed(2)}},{data:"throw_away",title:"THROW AWAY",render:function(a){return parseFloat(a||0).toFixed(2)}},{data:"early_molds",title:"EARLY MOLDS",render:function(a){return parseFloat(a||0).toFixed(2)}},{data:"pull_out",title:"PULL OUT",render:function(a){return parseFloat(a||0).toFixed(2)}},{data:"rat_bites",title:"RAT BITES",render:function(a){return parseFloat(a||0).toFixed(2)}},{data:"ant_bites",title:"ANT BITES",render:function(a){return parseFloat(a||0).toFixed(2)}},{data:"total_price",title:"TOTAL PRICE",render:function(a){return"₱"+parseFloat(a||0).toFixed(2)}}],T={paging:!0,pageLength:25,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf","print"]},g=()=>{if(o.value&&s.value){const a=new Date(o.value),t=new Date(s.value);if(a>t){alert("Start date cannot be later than end date");return}}O.get(route("reports.bo"),{startDate:o.value||null,endDate:s.value||null,stores:l.value.length>0?l.value:null},{preserveState:!0,preserveScroll:!0})};let p;E([l,o,s],()=>{clearTimeout(p),p=setTimeout(g,500)},{deep:!0}),S(()=>{clearTimeout(p)});const d=_(()=>f.value.reduce((a,t)=>(a.throw_away+=parseFloat(t.throw_away||0),a.early_molds+=parseFloat(t.early_molds||0),a.pull_out+=parseFloat(t.pull_out||0),a.rat_bites+=parseFloat(t.rat_bites||0),a.ant_bites+=parseFloat(t.ant_bites||0),a.total_price+=parseFloat(t.total_price||0),a),{throw_away:0,early_molds:0,pull_out:0,rat_bites:0,ant_bites:0,total_price:0})),D=()=>{l.value=[],o.value="",s.value="",g()};return(a,t)=>(b(),R(k,{"active-tab":"ORDER"},{main:x(()=>[e("div",L,[n.userRole.toUpperCase()==="ADMIN"||n.userRole.toUpperCase()==="SUPERADMIN"?(b(),C("div",V,[c(U,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=r=>l.value=r),options:n.stores,label:"Stores"},null,8,["modelValue","options"])])):B("",!0),e("div",P,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),v(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=r=>o.value=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[w,o.value]])]),e("div",q,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),v(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=r=>s.value=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[w,s.value]])]),e("div",{class:"flex items-end"},[e("button",{onClick:D,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),e("details",Y,[t[11]||(t[11]=e("summary",{class:"collapse-title text-sm font-medium"},"BAD ORDERS SUMMARY",-1)),e("div",W,[e("div",j,[e("div",H,[t[5]||(t[5]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Throw Away",-1)),e("p",$,i(d.value.throw_away.toFixed(2)),1)]),e("div",G,[t[6]||(t[6]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Early Molds",-1)),e("p",X,i(d.value.early_molds.toFixed(2)),1)]),e("div",z,[t[7]||(t[7]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Pull Out",-1)),e("p",J,i(d.value.pull_out.toFixed(2)),1)]),e("div",K,[t[8]||(t[8]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Rat Bites",-1)),e("p",Q,i(d.value.rat_bites.toFixed(2)),1)]),e("div",Z,[t[9]||(t[9]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Ant Bites",-1)),e("p",tt,i(d.value.ant_bites.toFixed(2)),1)]),e("div",et,[t[10]||(t[10]=e("h3",{class:"text-sm font-medium text-gray-500 uppercase"},"Total Price",-1)),e("p",at,"₱"+i(d.value.total_price.toFixed(2)),1)])])])]),c(I,null,{default:x(()=>[c(M(y),{data:f.value,columns:h,class:"w-full relative display",options:T},null,8,["data"])]),_:1})]),_:1}))}};export{gt as default};
