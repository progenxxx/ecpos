import{d as F,s as g,k as M,c as x,w as h,C as U,o as f,a as n,e as k,b as w,f as I,j as N,v as q,u as B}from"./app-C52hVfJY.js";import{_ as O}from"./AdminPanel-Lz0a11Ng.js";import{_ as P}from"./Main-Dvk5MXMN.js";import{_ as G}from"./MultiSelectDropdown-3Sp06M2v.js";import{T as L}from"./TableContainer-DDO88sOS.js";import"./buttons.print-D7Xl1u5x.js";import{P as D,D as R}from"./dataTables-QVPD_hK-.js";import{E as j}from"./exceljs.min-DNiw8cyP.js";import"./RetailGroup-B-ZKk-7u.js";import"./Logout-DjX50YFP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-Bw9dwv6a.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-B_t0RILE.js";import"./RetailItems-sFnzHpqc.js";import"./Attendance-DKYwb2tw.js";import"./PartyCake143-D6oM8iE8.js";const $={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow z-[999]"},Q={key:0,class:"flex-1 min-w-[200px]"},W={class:"flex-1 min-w-[200px]"},z={class:"flex-1 min-w-[200px]"},J={class:"flex items-end"},X={key:1},pt={__name:"ItemSales",props:{ec:{type:Array,required:!0},auth:{type:Object,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(v){D.use(R);const m=F([]),d=F(""),c=F(""),p=v,A=g(()=>p.userRole.toUpperCase()==="STORE"?P:O);M(()=>{m.value=p.filters.selectedStores||[],d.value=p.filters.startDate||"",c.value=p.filters.endDate||""});const b=g(()=>{let t=[...p.ec];return m.value.length>0&&(t=t.filter(e=>m.value.includes(e.storename))),d.value&&c.value&&(t=t.filter(e=>{const a=new Date(e.createddate),l=new Date(d.value),r=new Date(c.value);return a>=l&&a<=r})),t}),u=g(()=>b.value.reduce((t,e)=>(t.total_discamount+=parseFloat(e.total_discamount)||0,t.total_costprice+=parseFloat(e.total_costprice)||0,t.total_netamount+=parseFloat(e.total_netamount)||0,t.vatablesales+=parseFloat(e.vatablesales)||0,t.vat+=parseFloat(e.vat)||0,t.total_grossamount+=parseFloat(e.total_grossamount)||0,t.total_costamount+=parseFloat(e.total_costamount)||0,t.total_qty+=Math.round(e.qty||0),t),{total_qty:0,total_discamount:0,total_costprice:0,total_netamount:0,vatablesales:0,vat:0,total_grossamount:0,total_costamount:0})),C=[{data:"itemname",title:"Item Name",footer:"Grand Total"},{data:"itemgroup",title:"Item Group"},{data:"price",title:"Price"},{data:"qty",title:"Qty",render:t=>Math.round(t),footer:()=>Math.round(u.value.total_qty)},{data:"total_costprice",title:"Cost Price",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.total_costprice.toFixed(2)},{data:"total_grossamount",title:"Gross Amount",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.total_grossamount.toFixed(2)},{data:"total_costamount",title:"Cost Amount",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.total_costamount.toFixed(2)},{data:"total_discamount",title:"Discount Amount",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.total_discamount.toFixed(2)},{data:"total_netamount",title:"Net Amount",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.total_netamount.toFixed(2)},{data:"vatablesales",title:"Vatable Sales",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.vatablesales.toFixed(2)},{data:"vat",title:"VAT",render:t=>(parseFloat(t)||0).toFixed(2),footer:()=>u.value.vat.toFixed(2)}],S={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",scrollX:!0,scrollY:"50vh",buttons:["copy",{text:"Export Excel",action:function(t,e,a,l){T(e)}},"pdf","print"],drawCallback:function(t){const e=new R.Api(t),a=e.table().footer().querySelectorAll("td, th"),l={total_qty:0,total_costprice:0,total_grossamount:0,total_costamount:0,total_discamount:0,total_netamount:0,vatablesales:0,vat:0};e.rows({search:"applied"}).every(function(i){const o=this.data();l.total_qty+=Math.round(parseFloat(o.qty||0)),l.total_costprice+=parseFloat(o.total_costprice||0),l.total_grossamount+=parseFloat(o.total_grossamount||0),l.total_costamount+=parseFloat(o.total_costamount||0),l.total_discamount+=parseFloat(o.total_discamount||0),l.total_netamount+=parseFloat(o.total_netamount||0),l.vatablesales+=parseFloat(o.vatablesales||0),l.vat+=parseFloat(o.vat||0)}),["total_qty","total_costprice","total_grossamount","total_costamount","total_discamount","total_netamount","vatablesales","vat"].forEach((i,o)=>{const s=a[o+3];if(s){const _=l[i];s.textContent=i==="total_qty"?Math.round(_):_.toFixed(2)}})}},T=t=>{const e=new j.Workbook,a=e.addWorksheet("Sales Data");a.columns=[{header:"Item Name",key:"itemname",width:30},{header:"Item Group",key:"itemgroup",width:20},{header:"Price",key:"price",width:15,style:{numFmt:"#,##0.00"}},{header:"Qty",key:"qty",width:10,style:{numFmt:"#,##0"}},{header:"Cost Price",key:"total_costprice",width:15,style:{numFmt:"#,##0.00"}},{header:"Gross Amount",key:"total_grossamount",width:15,style:{numFmt:"#,##0.00"}},{header:"Cost Amount",key:"total_costamount",width:15,style:{numFmt:"#,##0.00"}},{header:"Discount Amount",key:"total_discamount",width:15,style:{numFmt:"#,##0.00"}},{header:"Net Amount",key:"total_netamount",width:15,style:{numFmt:"#,##0.00"}},{header:"Vatable Sales",key:"vatablesales",width:15,style:{numFmt:"#,##0.00"}},{header:"VAT",key:"vat",width:15,style:{numFmt:"#,##0.00"}}],a.getRow(1).font={bold:!0},a.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF343A40"}},a.getRow(1).font={color:{argb:"FFFFFFFF"},bold:!0};const l=t.rows({search:"applied"}).data().toArray();l.forEach(o=>{a.addRow({itemname:o.itemname||"N/A",itemgroup:o.itemgroup||"N/A",price:Number(o.price)||0,qty:Math.round(Number(o.qty))||0,total_costprice:Number(o.total_costprice)||0,total_grossamount:Number(o.total_grossamount)||0,total_costamount:Number(o.total_costamount)||0,total_discamount:Number(o.total_discamount)||0,total_netamount:Number(o.total_netamount)||0,vatablesales:Number(o.vatablesales)||0,vat:Number(o.vat)||0})});const r=l.reduce((o,s)=>({total_qty:o.total_qty+Math.round(Number(s.qty)||0),total_costprice:o.total_costprice+(Number(s.total_costprice)||0),total_grossamount:o.total_grossamount+(Number(s.total_grossamount)||0),total_costamount:o.total_costamount+(Number(s.total_costamount)||0),total_discamount:o.total_discamount+(Number(s.total_discamount)||0),total_netamount:o.total_netamount+(Number(s.total_netamount)||0),vatablesales:o.vatablesales+(Number(s.vatablesales)||0),vat:o.vat+(Number(s.vat)||0)}),{total_qty:0,total_costprice:0,total_grossamount:0,total_costamount:0,total_discamount:0,total_netamount:0,vatablesales:0,vat:0}),i=a.addRow({itemname:"Grand Total",itemgroup:"",price:"",qty:r.total_qty,total_costprice:r.total_costprice,total_grossamount:r.total_grossamount,total_costamount:r.total_costamount,total_discamount:r.total_discamount,total_netamount:r.total_netamount,vatablesales:r.vatablesales,vat:r.vat});i.font={bold:!0},i.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF007BFF"}},i.font={color:{argb:"FFFFFFFF"},bold:!0},e.xlsx.writeBuffer().then(o=>{const s=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),_=window.URL.createObjectURL(s),y=document.createElement("a");y.href=_;const E=new Date().toISOString().split("T")[0],V=new Date().toLocaleTimeString().replace(/:/g,"-");y.download=`ItemSales_Report_${E}_${V}.xlsx`,y.click(),window.URL.revokeObjectURL(_)})};return(t,e)=>(f(),x(U(A.value),{"active-tab":"REPORTS"},{main:h(()=>[n("div",$,[v.userRole.toUpperCase()==="ADMIN"||v.userRole.toUpperCase()==="SUPERADMIN"?(f(),k("div",Q,[w(G,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),options:v.stores,label:"Stores"},null,8,["modelValue","options"])])):I("",!0),n("div",W,[e[4]||(e[4]=n("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),N(n("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[q,d.value]])]),n("div",z,[e[5]||(e[5]=n("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),N(n("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>c.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[q,c.value]])]),n("div",J,[n("button",{onClick:e[3]||(e[3]=()=>{m.value=[],d.value="",c.value=""}),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),w(L,{class:"overflow-auto"},{default:h(()=>[b.value.length>0?(f(),x(B(D),{key:0,data:b.value,columns:C,class:"w-full relative display",options:S},{action:h(a=>e[6]||(e[6]=[])),_:1},8,["data"])):(f(),k("p",X,"No data available for the selected filters."))]),_:1})]),_:1}))}};export{pt as default};
