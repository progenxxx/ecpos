import{_ as R}from"./SuccessButton-B5RCiPM3.js";import{E as M}from"./exceljs.min-4JhihTCQ.js";import{F as S}from"./FileSaver.min-C0FIk2rq.js";import{E as O}from"./Excel-Cx0Q9t9G.js";import{P as y,D as b}from"./dataTables-BXgh5MYr.js";import{T as $}from"./TableContainer-BHVeCArx.js";import{_ as B}from"./AdminPanel-BwjEDCtJ.js";import"./dataTables.fixedColumns-D9A0BWYI.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{d as c,k as Y,s as q,c as G,w as p,o as h,b as f,a as x,e as w,u as L}from"./app-D4KRJyko.js";import"./RetailGroup-6t20PwtR.js";import"./Logout-8hw4reCp.js";/* empty css                                                             */import"./Modal-C1bDdoN8.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-5n6bCmaZ.js";import"./RetailItems-Dce1d_bp.js";import"./Attendance-DvpGN19-.js";const Q={class:"absolute flex justify-start items-center"},P={key:0,class:"overflow-x-auto"},U={key:1,class:"text-center py-4"},J={__name:"Inventory copy",props:{initialItems:{type:Array,default:()=>[]},currentMonth:String,JOURNALID:String},setup(_){y.use(b),y.use(b);const l=_,n=c(l.initialItems.map(t=>({...t,quantities:t.quantities||{}}))),s=c([]);c(!1),c(!1),c(!1),Y(()=>{if(console.log("Initial items:",l.initialItems),console.log("Processed items:",n.value),l.currentMonth){const t=new Date(l.currentMonth),e=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();s.value=Array.from({length:e},(o,a)=>a+1)}});const u=(t,e)=>t.quantities[e]||0,E=(t,e,o)=>{t.quantities[e]=Number(o)},m=t=>s.value.reduce((e,o)=>e+u(t,o),0),I=t=>n.value.reduce((e,o)=>e+u(o,t),0),T=()=>n.value.reduce((t,e)=>t+m(e),0),i=q(()=>[{title:"ITEMS",data:"name"},{title:"CATEGORY",data:"category"},...s.value.map(t=>({title:`${t}/${l.currentMonth.split(" ")[0].substring(0,3)}`,data:null,render:(e,o,a)=>`
        <input
          type="number"
          value="${u(a,t)}"
          onchange="window.setQuantity('${a.id}', ${t}, this.value)"
          class="w-16 px-2 py-1 border rounded"
          min="0"
        >
      `})),{title:"TOTAL",data:null,render:(t,e,o)=>m(o)}]),D={responsive:!0,processing:!0,serverSide:!1,paging:!1,scrollX:!0,scrollY:"70vh",scrollCollapse:!0,searching:!0,info:!0,ordering:!1,fixedColumns:{leftColumns:2}};window.setQuantity=(t,e,o)=>{const a=n.value.find(g=>g.id===t);a&&E(a,e,o)};const k=()=>{console.log("Updating inventory...")};async function A(){if(console.log("Starting export to Excel"),!n.value.length||!s.value.length){alert("No data available to export.");return}try{const t=new M.Workbook,e=t.addWorksheet("Inventory");console.log("Defining columns"),e.columns=i.value.map(r=>({header:r.title,key:r.title,width:15})),console.log("Adding header row"),e.addRow(i.value.map(r=>r.title)),console.log("Adding data rows"),n.value.forEach(r=>{const v=i.value.map(d=>{if(d.title==="ITEMS")return r.name;if(d.title==="CATEGORY")return r.category;if(d.title==="TOTAL")return m(r);const F=parseInt(d.title.split("/")[0]);return u(r,F)});e.addRow(v)}),console.log("Adding footer row");const o=e.addRow(i.value.map(r=>{if(r.title==="TOTAL")return T();if(r.title!=="ITEMS"&&r.title!=="CATEGORY"){const v=parseInt(r.title.split("/")[0]);return I(v)}return""}));o.font={bold:!0},o.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF7C0000"}},o.font={color:{argb:"FFDDDDDD"}},console.log("Styling header row"),e.getRow(1).font={bold:!0},e.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF8F9FA"}},console.log("Generating Excel file");const a=`Inventory_${l.currentMonth.replace(" ","_")}.xlsx`,g=await t.xlsx.writeBuffer(),C=new Blob([g],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});S.saveAs(C,a),console.log("Excel export completed")}catch(t){console.error("Error exporting to Excel:",t),alert("An error occurred while exporting to Excel. Please try again.")}}return(t,e)=>(h(),G(B,{"active-tab":"ORDER"},{modals:p(()=>e[0]||(e[0]=[])),main:p(()=>[f($,null,{default:p(()=>[x("div",Q,[x("button",{onClick:k,class:"ml-4 mt-4 px-4 py-2 bg-blue-500 text-white rounded bg-navy hover:bg-blue-600"}," Update Inventory "),f(R,{type:"button",onClick:A,class:"ml-6 bg-green"},{default:p(()=>[f(O,{class:"h-4"})]),_:1})]),n.value.length&&s.value.length?(h(),w("div",P,[f(L(y),{columns:i.value,data:n.value,options:D,class:"w-full relative display"},null,8,["columns","data"])])):(h(),w("div",U," No inventory data available. "))]),_:1})]),_:1}))}},ct=N(J,[["__scopeId","data-v-4b323087"]]);export{ct as default};
