import{T as h,o as y,c as V,w as u,a as s,i as j,b as o,u as e,j as k,v as E,q as S,g as U,n as B,t as q,l as G,d as m,f as $}from"./app-CWbsghfQ.js";import{_ as T,M as I}from"./Modal-DTsuLBrX.js";import{_ as A}from"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-Bmfe4oq8.js";import{_ as f,a as p}from"./TextInput-D7B3hvvQ.js";import{_ as c}from"./InputLabel-BGOTATYG.js";import{_ as M}from"./TransparentButton-dnCRvYzW.js";import{_ as J}from"./AdminPanel-CYInrTuX.js";import{A as K}from"./Add-BuVxutvd.js";import{e as Q}from"./editblue-CxDqBGne.js";import{T as Z}from"./TableContainer-6VgDCbb7.js";import{P as D,D as ee}from"./dataTables-D5Vo52-h.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RetailGroup-BW1tkHLf.js";import"./Logout-BoWuqpqH.js";/* empty css                                                             */import"./RetailItems-CtMdT1Ax.js";import"./Attendance-D6oEmBx9.js";const oe={class:"p-6"},se={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},te={class:"flex items-center"},re={class:"flex items-center justify-end mt-6 space-x-3"},le={__name:"Create",props:{showModal:{type:Boolean,default:!1}},emits:["toggleActive"],setup(b,{emit:w}){const d=w,l=h({version_number:"",version_name:"",release_notes:"",download_url:"",force_update:!1,min_supported_version:""}),r=()=>{l.post("/app-versions",{onSuccess:()=>{l.reset(),d("toggleActive")},onError:v=>{console.error("Create version errors:",v)}})},g=()=>{l.reset(),d("toggleActive")};return(v,a)=>(y(),V(I,{show:b.showModal,onClose:g},{default:u(()=>[s("div",oe,[a[8]||(a[8]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Create New App Version ",-1)),s("form",{onSubmit:j(r,["prevent"]),class:"space-y-4"},[s("div",se,[s("div",null,[o(c,{for:"version_number",value:"Version Number *"}),o(f,{id:"version_number",modelValue:e(l).version_number,"onUpdate:modelValue":a[0]||(a[0]=t=>e(l).version_number=t),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 1.0.0",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(l).errors.version_number},null,8,["message"])]),s("div",null,[o(c,{for:"version_name",value:"Version Name *"}),o(f,{id:"version_name",modelValue:e(l).version_name,"onUpdate:modelValue":a[1]||(a[1]=t=>e(l).version_name=t),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Major Update",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(l).errors.version_name},null,8,["message"])]),s("div",null,[o(c,{for:"min_supported_version",value:"Min Supported Version *"}),o(f,{id:"min_supported_version",modelValue:e(l).min_supported_version,"onUpdate:modelValue":a[2]||(a[2]=t=>e(l).min_supported_version=t),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 0.9.0",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(l).errors.min_supported_version},null,8,["message"])]),s("div",null,[o(c,{for:"download_url",value:"Download URL"}),o(f,{id:"download_url",modelValue:e(l).download_url,"onUpdate:modelValue":a[3]||(a[3]=t=>e(l).download_url=t),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com/app.apk",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(l).errors.download_url},null,8,["message"])])]),s("div",null,[o(c,{for:"release_notes",value:"Release Notes"}),k(s("textarea",{id:"release_notes","onUpdate:modelValue":a[4]||(a[4]=t=>e(l).release_notes=t),rows:"4",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"What's new in this version..."},null,512),[[E,e(l).release_notes]]),o(p,{class:"mt-2",message:e(l).errors.release_notes},null,8,["message"])]),s("div",te,[k(s("input",{id:"force_update","onUpdate:modelValue":a[5]||(a[5]=t=>e(l).force_update=t),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[S,e(l).force_update]]),a[6]||(a[6]=s("label",{for:"force_update",class:"ml-2 text-sm text-gray-700"}," Force Update (Users cannot skip this update) ",-1))]),s("div",re,[o(T,{type:"button",onClick:g},{default:u(()=>a[7]||(a[7]=[U(" Cancel ")])),_:1}),o(A,{type:"submit",class:B({"opacity-25":e(l).processing}),disabled:e(l).processing},{default:u(()=>[U(q(e(l).processing?"Creating...":"Create Version"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]))}},ae={class:"p-6"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ie={class:"space-y-2"},de={class:"flex items-center"},ue={class:"flex items-center"},me={class:"flex items-center justify-end mt-6 space-x-3"},pe={__name:"Update",props:{showModal:{type:Boolean,default:!1},versionId:{type:[String,Number],default:null},versionNumber:{type:String,default:""},versionName:{type:String,default:""},releaseNotes:{type:String,default:""},downloadUrl:{type:String,default:""},forceUpdate:{type:Boolean,default:!1},minSupportedVersion:{type:String,default:""},isActive:{type:Boolean,default:!1}},emits:["toggleActive"],setup(b,{emit:w}){const d=b,l=w,r=h({version_number:"",version_name:"",release_notes:"",download_url:"",force_update:!1,min_supported_version:"",is_active:!1});G(()=>d.showModal,a=>{a&&(r.version_number=d.versionNumber,r.version_name=d.versionName,r.release_notes=d.releaseNotes||"",r.download_url=d.downloadUrl||"",r.force_update=d.forceUpdate,r.min_supported_version=d.minSupportedVersion,r.is_active=d.isActive)});const g=()=>{r.put(`/app-versions/${d.versionId}`,{onSuccess:()=>{l("toggleActive")},onError:a=>{console.error("Update version errors:",a)}})},v=()=>{r.clearErrors(),l("toggleActive")};return(a,t)=>(y(),V(I,{show:b.showModal,onClose:v},{default:u(()=>[s("div",ae,[t[10]||(t[10]=s("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Edit App Version ",-1)),s("form",{onSubmit:j(g,["prevent"]),class:"space-y-4"},[s("div",ne,[s("div",null,[o(c,{for:"version_number_edit",value:"Version Number *"}),o(f,{id:"version_number_edit",modelValue:e(r).version_number,"onUpdate:modelValue":t[0]||(t[0]=i=>e(r).version_number=i),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 1.0.0",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(r).errors.version_number},null,8,["message"])]),s("div",null,[o(c,{for:"version_name_edit",value:"Version Name *"}),o(f,{id:"version_name_edit",modelValue:e(r).version_name,"onUpdate:modelValue":t[1]||(t[1]=i=>e(r).version_name=i),type:"text",class:"mt-1 block w-full",placeholder:"e.g., Major Update",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(r).errors.version_name},null,8,["message"])]),s("div",null,[o(c,{for:"min_supported_version_edit",value:"Min Supported Version *"}),o(f,{id:"min_supported_version_edit",modelValue:e(r).min_supported_version,"onUpdate:modelValue":t[2]||(t[2]=i=>e(r).min_supported_version=i),type:"text",class:"mt-1 block w-full",placeholder:"e.g., 0.9.0",required:"",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(r).errors.min_supported_version},null,8,["message"])]),s("div",null,[o(c,{for:"download_url_edit",value:"Download URL"}),o(f,{id:"download_url_edit",modelValue:e(r).download_url,"onUpdate:modelValue":t[3]||(t[3]=i=>e(r).download_url=i),type:"url",class:"mt-1 block w-full",placeholder:"https://example.com/app.apk",autocomplete:"off"},null,8,["modelValue"]),o(p,{class:"mt-2",message:e(r).errors.download_url},null,8,["message"])])]),s("div",null,[o(c,{for:"release_notes_edit",value:"Release Notes"}),k(s("textarea",{id:"release_notes_edit","onUpdate:modelValue":t[4]||(t[4]=i=>e(r).release_notes=i),rows:"4",class:"mt-1 block w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",placeholder:"What's new in this version..."},null,512),[[E,e(r).release_notes]]),o(p,{class:"mt-2",message:e(r).errors.release_notes},null,8,["message"])]),s("div",ie,[s("div",de,[k(s("input",{id:"force_update_edit","onUpdate:modelValue":t[5]||(t[5]=i=>e(r).force_update=i),type:"checkbox",class:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[S,e(r).force_update]]),t[7]||(t[7]=s("label",{for:"force_update_edit",class:"ml-2 text-sm text-gray-700"}," Force Update (Users cannot skip this update) ",-1))]),s("div",ue,[k(s("input",{id:"is_active_edit","onUpdate:modelValue":t[6]||(t[6]=i=>e(r).is_active=i),type:"checkbox",class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[S,e(r).is_active]]),t[8]||(t[8]=s("label",{for:"is_active_edit",class:"ml-2 text-sm text-gray-700"}," Set as Active Version ",-1))])]),s("div",me,[o(T,{type:"button",onClick:v},{default:u(()=>t[9]||(t[9]=[U(" Cancel ")])),_:1}),o(A,{type:"submit",class:B({"opacity-25":e(r).processing}),disabled:e(r).processing},{default:u(()=>[U(q(e(r).processing?"Updating...":"Update Version"),1)]),_:1},8,["class","disabled"])])],32)])]),_:1},8,["show"]))}},ce={class:"absolute adjust"},ve={class:"flex justify-start items-center"},_e={class:"flex justify-start space-x-1"},je={__name:"Index",props:{versions:{type:Array,required:!0}},setup(b){D.use(ee);const w=m(""),d=m(""),l=m(""),r=m(""),g=m(""),v=m(!1),a=m(""),t=m(!1),i=m(!1),C=m(!1),F=[{data:"version_number",title:"Version"},{data:"version_name",title:"Name"},{data:"is_active",title:"Status",render:function(n){return n?'<span class="bg-green-100 text-green-800 text-xs font-medium px-2.5 py-0.5 rounded">Active</span>':'<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded">Inactive</span>'}},{data:"force_update",title:"Force Update",render:function(n){return n?'<span class="bg-red-100 text-red-800 text-xs font-medium px-2.5 py-0.5 rounded">Yes</span>':'<span class="bg-gray-100 text-gray-800 text-xs font-medium px-2.5 py-0.5 rounded">No</span>'}},{data:"min_supported_version",title:"Min Version"},{data:"created_at",title:"Created",render:function(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}},{data:null,render:"#action",title:"Actions"}],L={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,order:[[5,"desc"]]},R=n=>{w.value=n.id,d.value=n.version_number,l.value=n.version_name,r.value=n.release_notes||"",g.value=n.download_url||"",v.value=n.force_update,a.value=n.min_supported_version,t.value=n.is_active,i.value=!0},H=()=>{C.value=!0},P=()=>{i.value=!1},W=()=>{C.value=!1},Y=h({}),z=h({}),O=n=>{if(n.is_active){alert("Cannot delete the active version. Please set another version as active first.");return}confirm(`Are you sure you want to delete version ${n.version_number}?`)&&Y.delete(`/app-versions/${n.id}`,{onSuccess:()=>{},onError:_=>{console.error("Delete version errors:",_),alert("Error deleting version")}})},X=n=>{n.is_active||confirm(`Set version ${n.version_number} as active?`)&&z.post(`/app-versions/${n.id}/set-active`,{onSuccess:()=>{},onError:_=>{console.error("Set active version errors:",_),alert("Error setting active version")}})};return(n,_)=>(y(),V(J,{"active-tab":"VERSION"},{modals:u(()=>[o(le,{"show-modal":C.value,onToggleActive:W},null,8,["show-modal"]),o(pe,{"show-modal":i.value,"version-id":w.value,"version-number":d.value,"version-name":l.value,"release-notes":r.value,"download-url":g.value,"force-update":v.value,"min-supported-version":a.value,"is-active":t.value,onToggleActive:P},null,8,["show-modal","version-id","version-number","version-name","release-notes","download-url","force-update","min-supported-version","is-active"])]),main:u(()=>[o(Z,null,{default:u(()=>[s("div",ce,[s("div",ve,[o(A,{type:"button",onClick:H,class:"m-6 bg-navy"},{default:u(()=>[o(K,{class:"h-4"})]),_:1})])]),o(e(D),{data:b.versions,columns:F,class:"w-full relative display",options:L},{action:u(x=>[s("div",_e,[x.cellData.is_active?$("",!0):(y(),V(M,{key:0,type:"button",onClick:N=>X(x.cellData),class:"text-green-600 hover:text-green-800",title:"Set Active"},{default:u(()=>_[0]||(_[0]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1)])),_:2},1032,["onClick"])),o(M,{type:"button",onClick:N=>R(x.cellData),title:"Edit"},{default:u(()=>[o(Q,{class:"h-4"})]),_:2},1032,["onClick"]),x.cellData.is_active?$("",!0):(y(),V(M,{key:1,type:"button",onClick:N=>O(x.cellData),class:"text-red-600 hover:text-red-800",title:"Delete"},{default:u(()=>_[1]||(_[1]=[s("svg",{class:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])),_:2},1032,["onClick"]))])]),_:1},8,["data"])]),_:1})]),_:1}))}};export{je as default};
