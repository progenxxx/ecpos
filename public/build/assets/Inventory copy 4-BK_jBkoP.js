import{q as v,d as p,l as V,E,k as M,c as _,w,B as I,o as m,a as t,e as c,b as N,f as O,j as h,v as F,t as r,u as U,N as P}from"./app-BoaMMdkU.js";import{_ as j}from"./AdminPanel-CRYPwC5J.js";import{_ as q}from"./Main-BbjkEZ83.js";import{_ as $}from"./MultiSelectDropdown-CvWO6dSB.js";import{T as L}from"./TableContainer-B85p6F6Z.js";import{P as D,D as W}from"./dataTables-CI4NjUw-.js";import"./buttons.print-DL4ItSDN.js";import"./exceljs.min-CzHtFhDI.js";import"./RetailGroup-BjeigQ0x.js";import"./Logout-BJuIbz2k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-5-iMnX7J.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-DFF7VX6Y.js";import"./RetailItems-BB1M731N.js";import"./Attendance-CU9DKH9f.js";import"./PartyCake143-BDy8Cxyz.js";const z={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow z-[999]"},G={key:0,class:"flex-1 min-w-[200px]"},H={class:"flex-1 min-w-[200px]"},J={class:"flex-1 min-w-[200px]"},K={class:"mb-4 bg-white rounded-lg shadow",open:""},Q={class:"p-4"},X={key:0,class:"flex justify-center items-center py-8"},Y={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Z={class:"bg-gray-50 p-4 rounded-lg"},ee={class:"text-2xl mt-1"},te={class:"bg-gray-50 p-4 rounded-lg"},se={class:"text-2xl mt-1"},ae={class:"bg-gray-50 p-4 rounded-lg"},le={class:"text-2xl mt-1"},re={class:"bg-gray-50 p-4 rounded-lg"},oe={class:"flex justify-between mt-1"},ne={class:"text-lg"},ie={class:"text-lg"},de={class:"bg-gray-50 p-4 rounded-lg"},ue={class:"text-2xl mt-1"},ge={class:"bg-gray-50 p-4 rounded-lg"},me={class:"text-2xl mt-1"},xe={class:"bg-gray-50 p-4 rounded-lg"},ve={class:"text-2xl mt-1 font-bold"},pe={class:"bg-gray-50 p-4 rounded-lg col-span-1"},ce={class:"flex justify-between mt-1"},ye={class:"text-xl text-red-600"},be={class:"text-xl text-green-600"},fe={class:"bg-gray-50 p-4 rounded-lg col-span-full"},_e={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},we={class:"text-lg"},Ne={class:"text-lg"},he={class:"text-lg"},Fe={class:"text-lg"},De={class:"text-lg"},Be={class:"bg-white rounded-lg shadow"},Se={key:0,class:"flex justify-center items-center py-12"},ze={__name:"Inventory copy 4",props:{inventory:{type:Array,required:!0,default:()=>[]},stores:{type:Array,required:!0,default:()=>[]},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})},url:{type:String,default:()=>route("reports.inventory")}},setup(x){D.use(W);const n=x,B=v(()=>n.userRole.toUpperCase()==="STORE"?q:j),g=p(n.filters.selectedStores||[]),i=p(n.filters.startDate||""),d=p(n.filters.endDate||""),u=p(!0),o=v(()=>{var s;return(s=n.inventory)!=null&&s.length?n.inventory.reduce((e,a)=>{const l=A=>Number(A||0),f=l(a.throw_away)+l(a.early_molds)+l(a.pull_out)+l(a.rat_bites)+l(a.ant_bites);return{beginning:e.beginning+l(a.beginning),receivedDelivery:e.receivedDelivery+l(a.received_delivery),stockTransfer:e.stockTransfer+l(a.stock_transfer),sales:e.sales+l(a.sales),bundleSales:e.bundleSales+l(a.bundle_sales||0),waste:e.waste+f,itemcount:e.itemcount+l(a.item_count),ending:e.ending+l(a.ending),variance:e.variance+l(a.variance),throwAway:e.throwAway+l(a.throw_away),earlyMolds:e.earlyMolds+l(a.early_molds),pullOut:e.pullOut+l(a.pull_out),ratBites:e.ratBites+l(a.rat_bites),antBites:e.antBites+l(a.ant_bites)}},{beginning:0,receivedDelivery:0,stockTransfer:0,sales:0,bundleSales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0}):{beginning:0,receivedDelivery:0,stockTransfer:0,sales:0,bundleSales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0}}),S=v(()=>{var s;return((s=n.inventory)==null?void 0:s.reduce((e,a)=>{const l=Number(a.variance||0);return l<0?e+l:e},0))||0}),k=v(()=>{var s;return((s=n.inventory)==null?void 0:s.reduce((e,a)=>{const l=Number(a.variance||0);return l>0?e+l:e},0))||0}),T=[{data:"itemname",title:"Item Name",className:"min-w-[200px]"},{data:"beginning",title:"Beginning",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"received_delivery",title:"Received",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"stock_transfer",title:"Stock Transfer",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"sales",title:"Direct Sales",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"bundle_sales",title:"Bundle Sales",className:"text-right",render:(s,e,a)=>Number(a.bundle_sales||0).toFixed(2)},{data:"throw_away",title:"Throw Away",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"early_molds",title:"Early Molds",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"pull_out",title:"Pull Out",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"rat_bites",title:"Rat Bites",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"ant_bites",title:"Ant Bites",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"item_count",title:"Item Count",className:"text-right",render:s=>Number(s||0).toFixed(2)},{data:"ending",title:"Ending",className:"text-right font-bold",render:s=>Number(s||0).toFixed(2)},{data:"variance",title:"Variance",className:"text-right",render:(s,e,a)=>{const l=Number(s||0);return`<span class="${l<0?"text-red-600":"text-green-600"} font-bold">${l.toFixed(2)}</span>`}}],C={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",deferRender:!0,buttons:["copy",{extend:"csv",title:"Inventory Report"},{extend:"excel",title:"Inventory Report"},{extend:"pdf",title:"Inventory Report"},"print"],drawCallback:function(){u.value=!1}},b=()=>{if(i.value&&d.value){const s=new Date(i.value),e=new Date(d.value);if(s>e){alert("Start date cannot be later than end date");return}}u.value=!0,P.get(route("reports.inventory"),{startDate:i.value,endDate:d.value,stores:g.value},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{u.value=!1},onError:s=>{console.error("Filter update failed:",s),u.value=!1}})},R=()=>{g.value=[],i.value="",d.value="",b()};let y;return V([g,i,d],()=>{clearTimeout(y),y=setTimeout(b,500)},{deep:!0}),E(()=>{clearTimeout(y)}),M(()=>{g.value=n.filters.selectedStores||[],i.value=n.filters.startDate||"",d.value=n.filters.endDate||"",console.log("Inventory data:",n.inventory),setTimeout(()=>{u.value=!1},500)}),(s,e)=>(m(),_(I(B.value),{"active-tab":"REPORTS"},{main:w(()=>[t("div",z,[x.userRole.toUpperCase()==="ADMIN"||x.userRole.toUpperCase()==="SUPERADMIN"?(m(),c("div",G,[N($,{modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=a=>g.value=a),options:x.stores,label:"Stores"},null,8,["modelValue","options"])])):O("",!0),t("div",H,[e[3]||(e[3]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>i.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[F,i.value]])]),t("div",J,[e[4]||(e[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),h(t("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[F,d.value]])]),t("div",{class:"flex items-end"},[t("button",{onClick:R,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),t("details",K,[e[24]||(e[24]=t("summary",{class:"px-4 py-3 text-lg font-medium cursor-pointer"}," Inventory Summary ",-1)),t("div",Q,[u.value?(m(),c("div",X,e[5]||(e[5]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"},null,-1),t("span",{class:"ml-3"},"Loading data...",-1)]))):(m(),c("div",Y,[t("div",Z,[e[6]||(e[6]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Beginning Balance",-1)),t("p",ee,r(o.value.beginning.toFixed(2)),1)]),t("div",te,[e[7]||(e[7]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Received",-1)),t("p",se,r(o.value.receivedDelivery.toFixed(2)),1)]),t("div",ae,[e[8]||(e[8]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Stock Transfer",-1)),t("p",le,r(o.value.stockTransfer.toFixed(2)),1)]),t("div",re,[e[11]||(e[11]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Sales",-1)),t("div",oe,[t("div",null,[e[9]||(e[9]=t("span",{class:"text-sm text-gray-500"},"Direct:",-1)),t("p",ne,r(o.value.sales.toFixed(2)),1)]),t("div",null,[e[10]||(e[10]=t("span",{class:"text-sm text-gray-500"},"Bundle:",-1)),t("p",ie,r(o.value.bundleSales.toFixed(2)),1)])])]),t("div",de,[e[12]||(e[12]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Waste",-1)),t("p",ue,r(o.value.waste.toFixed(2)),1)]),t("div",ge,[e[13]||(e[13]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Current Count",-1)),t("p",me,r(o.value.itemcount.toFixed(2)),1)]),t("div",xe,[e[14]||(e[14]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Ending Balance",-1)),t("p",ve,r(o.value.ending.toFixed(2)),1)]),t("div",pe,[e[17]||(e[17]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Variance",-1)),t("div",ce,[t("div",null,[e[15]||(e[15]=t("span",{class:"text-sm text-gray-500"},"Negative:",-1)),t("p",ye,r(S.value.toFixed(2)),1)]),t("div",null,[e[16]||(e[16]=t("span",{class:"text-sm text-gray-500"},"Positive:",-1)),t("p",be,r(k.value.toFixed(2)),1)])])]),t("div",fe,[e[23]||(e[23]=t("h3",{class:"text-sm font-semibold text-gray-600 mb-2"},"Waste Breakdown",-1)),t("div",_e,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-xs text-gray-500"},"Throw Away",-1)),t("p",we,r(o.value.throwAway.toFixed(2)),1)]),t("div",null,[e[19]||(e[19]=t("p",{class:"text-xs text-gray-500"},"Early Molds",-1)),t("p",Ne,r(o.value.earlyMolds.toFixed(2)),1)]),t("div",null,[e[20]||(e[20]=t("p",{class:"text-xs text-gray-500"},"Pull Out",-1)),t("p",he,r(o.value.pullOut.toFixed(2)),1)]),t("div",null,[e[21]||(e[21]=t("p",{class:"text-xs text-gray-500"},"Rat Bites",-1)),t("p",Fe,r(o.value.ratBites.toFixed(2)),1)]),t("div",null,[e[22]||(e[22]=t("p",{class:"text-xs text-gray-500"},"Ant Bites",-1)),t("p",De,r(o.value.antBites.toFixed(2)),1)])])])]))])]),t("div",Be,[u.value?(m(),c("div",Se,e[25]||(e[25]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"},null,-1),t("span",{class:"ml-4 text-lg"},"Loading inventory data...",-1)]))):(m(),_(L,{key:1},{default:w(()=>[N(U(D),{data:x.inventory,columns:T,class:"w-full relative display",options:C},null,8,["data"])]),_:1}))])]),_:1}))}};export{ze as default};
