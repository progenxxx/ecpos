import{d as f,k as R,s as v,c as S,w,C,o as x,a,e as E,b as g,f as U,j as _,v as y,u as T}from"./app-NPxLYQzb.js";import{_ as N}from"./AdminPanel-wIY7u0qA.js";import{_ as V}from"./Main-Dn4Ff29S.js";import{_ as B}from"./MultiSelectDropdown-_Igtj05o.js";import{T as L}from"./TableContainer-fwPJTGzy.js";import{P as b,D as G}from"./dataTables-B8uMeSpA.js";import"./buttons.print-DJaIPPVC.js";import{E as O}from"./exceljs.min-DeYFmjAR.js";import"./RetailGroup-v8sjJEH1.js";import"./Logout-CsEENbA9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-LJRun7uo.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-COOUSa13.js";import"./RetailItems-DeQMtUxX.js";import"./Attendance-BB-OHPzQ.js";import"./PartyCake143-wXgZtU6V.js";const j={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},q={key:0,class:"flex-1 min-w-[200px]"},M={class:"flex-1 min-w-[200px]"},$={class:"flex-1 min-w-[200px]"},P={class:"flex items-end"},lt={__name:"Sales copy",props:{ar:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(i){b.use(G);const s=f([]),l=f(""),u=f(""),r=i;R(()=>{s.value=r.filters.selectedStores||[],l.value=r.filters.startDate||"",u.value=r.filters.endDate||""});const D=v(()=>r.userRole.toUpperCase()==="STORE"?V:N),c=e=>`â‚±${parseFloat(e).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,k=v(()=>{let e=[...r.ar];return s.value.length>0&&(e=e.filter(t=>s.value.includes(t.storename))),l.value&&u.value&&(e=e.filter(t=>{const o=new Date(t.createddate),d=new Date(l.value),m=new Date(u.value);return o>=d&&o<=m})),e}),n=v(()=>k.value.reduce((e,t)=>({total_netamount:e.total_netamount+(parseFloat(t.total_netamount)||0),total_discamount:e.total_discamount+(parseFloat(t.total_discamount)||0),total_grossamount:e.total_grossamount+(parseFloat(t.total_grossamount)||0)}),{total_netamount:0,total_discamount:0,total_grossamount:0})),A=[{data:"store",title:"Store",footer:"Grand Total"},{data:"total_netamount",title:"Net Amount",render:function(e){return c(parseFloat(e)||0)},footer:function(){return n.value.total_netamount.toFixed(2)}},{data:"total_discamount",title:"Discount Amount",render:function(e){return c(parseFloat(e)||0)},footer:function(){return n.value.total_discamount.toFixed(2)}},{data:"total_grossamount",title:"Gross Amount",render:function(e){return c(parseFloat(e)||0)},footer:function(){return n.value.total_grossamount.toFixed(2)}}],h={responsive:!0,pageLength:25,dom:"Bfrtip",buttons:["copy",{text:"Export Excel",action:function(e,t,o,d){F()}},"pdf","print"],order:[[0,"asc"]]},F=()=>{const e=new O.Workbook,t=e.addWorksheet("Sales Report");t.addRow(["Store","Net Amount","Discount Amount","Gross Amount"]),t.columns=[{header:"Store",key:"store",width:20},{header:"Net Amount",key:"netAmount",width:20,style:{numFmt:"#,##0.00"}},{header:"Discount Amount",key:"discountAmount",width:20,style:{numFmt:"#,##0.00"}},{header:"Gross Amount",key:"grossAmount",width:20,style:{numFmt:"#,##0.00"}}],r.ar.forEach(o=>{t.addRow({store:o.store,netAmount:o.total_netamount,discountAmount:o.total_discamount,grossAmount:o.total_grossamount})}),t.addRow({store:"Grand Total",netAmount:n.value.total_netamount,discountAmount:n.value.total_discamount,grossAmount:n.value.total_grossamount}),e.xlsx.writeBuffer().then(o=>{const d=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=window.URL.createObjectURL(d),p=document.createElement("a");p.href=m,p.download="sales_report.xlsx",p.click(),window.URL.revokeObjectURL(m)})};return(e,t)=>(x(),S(C(D.value),{"active-tab":"REPORTS"},{main:w(()=>[a("div",j,[i.userRole.toUpperCase()==="ADMIN"||i.userRole.toUpperCase()==="SUPERADMIN"?(x(),E("div",q,[g(B,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value=o),options:i.stores,label:"Stores"},null,8,["modelValue","options"])])):U("",!0),a("div",M,[t[4]||(t[4]=a("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),_(a("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=o=>l.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,l.value]])]),a("div",$,[t[5]||(t[5]=a("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),_(a("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=o=>u.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[y,u.value]])]),a("div",P,[a("button",{onClick:t[3]||(t[3]=(...o)=>e.clearFilters&&e.clearFilters(...o)),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),g(L,null,{default:w(()=>[g(T(b),{data:r.ar,columns:A,class:"w-full relative display",options:h},null,8,["data"])]),_:1})]),_:1}))}};export{lt as default};
