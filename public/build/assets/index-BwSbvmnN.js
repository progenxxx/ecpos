import{C as W}from"./Create-DAU1riZ8.js";import{G as _,_ as F}from"./CopyFrom-D991gLfc.js";import{_ as b}from"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-DsXaYi2t.js";import{T as Y}from"./TableContainer-PwYTmfDA.js";import{_ as z}from"./Main-CQ_whzxT.js";import{S as P}from"./Save-CyUTnkDp.js";import{B as K}from"./Back-CCs1-C1O.js";import{C as Q}from"./Cart-BNCzhD23.js";import{d as u,T as X,H as D,c as Z,w as i,o as C,b as r,e as E,a as m,f as N,t as ee,n as T,g as I,u as te,D as oe}from"./app-DwAHA_Mt.js";import{P as O,D as ae}from"./dataTables-7Vvj0GSY.js";import"./Modal-DosvBnh2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./InputError-DMqsnpds.js";/* empty css                                                               *//* empty css                                                               */import"./Logout-96D5XcFa.js";/* empty css                                                             */import"./PartyCake143-DpGG8J3p.js";import"./Attendance-CVSU-1NF.js";const se={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-filter backdrop-blur-sm"},le={class:"flex justify-start items-center"},Ee={__name:"index",props:{inventjournaltransrepos:{type:Array,required:!0},inventjournaltrans:{type:Array,required:!0},journalid:{type:[String,Number],required:!0},items:{type:Array,required:!0}},setup(f){O.use(ae);const p=u("");u(""),u("");const y=u(!1),x=u(!1),v=u(!1),h=u(!1),k=f,A=[{data:"ITEMID",title:"ITEMID"},{data:"itemname",title:"ITEMNAME"},{data:"itemgroup",title:"CATEGORY"},{data:"stocks",title:"STOCKS"},{data:"moq",title:"MOQ"},{data:"COUNTED",title:"COUNTED",render:function(o,t,s){if(t==="display"){const n=Number(o);let e,a;return n===0?(e="#f3f3f3",a="black"):n<Number(s.moq)?(e="red",a="white"):(e="white",a="black"),`<input type="number" class="counted-input form-input block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50" value="${n.toFixed(0)}" min="0" step="1" style="background-color: ${e}; color: ${a};">`}return o}}],M={paging:!1,scrollX:!0,scrollY:"70vh",scrollCollapse:!0,drawCallback:function(o){this.api().rows().every(function(){const s=this.data(),e=this.node().querySelector(".counted-input");if(e){const a=Number(e.value);let c,d;a===0?(c="#f3f3f3",d="black"):a<Number(s.moq)?(c="red",d="white"):(c="white",d="black"),e.style.backgroundColor=c,e.style.color=d,e.addEventListener("change",w=>q(w,s))}})}},j=o=>{p.value=o,v.value=!0,console.log(p.value)},R=()=>{h.value=!1},S=()=>{v.value=!1},U=()=>{x.value=!1};X({StartDate:"",EndDate:""});const V=()=>{window.location.href="/order"},$=o=>{window.location.href=`/ViewOrders/${o}`},B=o=>{console.log("Selected Item:",o)},L=u([]),g=D({}),l=D({text:"",type:""}),q=(o,t)=>{const s=o.target.value;g[t.ITEMID]=s;const n=Number(s);let e,a;n===0?(e="#f3f3f3",a="black"):n<Number(t.moq)?(e="red",a="white"):(e="white",a="black"),o.target.style.backgroundColor=e,o.target.style.color=a},G=async()=>{var o,t,s,n;try{y.value=!0,l.text="Updating counted values...",l.type="info";const e=await oe.post("/api/update-all-counted-values",{journalId:k.journalid,updatedValues:g});if(e.data.success){console.log("All values updated successfully");for(const[a,c]of Object.entries(g)){const d=L.value.find(w=>w.ITEMID===a);d&&(d.COUNTED=c)}Object.keys(g).forEach(a=>delete g[a]),l.text=e.data.message,l.type="success",setTimeout(()=>{location.reload()},1e3)}else throw new Error(e.data.message)}catch(e){console.error("Error updating values:",e),l.text=((t=(o=e.response)==null?void 0:o.data)==null?void 0:t.message)||e.message||"You don't have any changes!",l.type="error",(n=(s=e.response)==null?void 0:s.data)!=null&&n.errors&&e.response.data.errors.forEach(a=>{console.error(a)})}finally{J(),setTimeout(()=>{y.value=!1},500)}},J=()=>{setTimeout(()=>{l.text="",l.type=""},5e3)},H=o=>{window.location.href=`/warehouse/orders/${o}`};return(o,t)=>(C(),Z(z,{"active-tab":"ORDER"},{modals:i(()=>[r(W,{"show-modal":h.value,JOURNALID:p.value,items:k.items,onToggleActive:R,onSelectItem:B},null,8,["show-modal","JOURNALID","items"]),r(_,{"show-modal":v.value,JOURNALID:p.value,onToggleActive:S},null,8,["show-modal","JOURNALID"]),r(F,{"show-modal":x.value,JOURNALID:p.value,onToggleActive:U},null,8,["show-modal","JOURNALID"])]),main:i(()=>[r(Y,null,{default:i(()=>[y.value?(C(),E("div",se,t[3]||(t[3]=[m("div",{class:"text-white text-2xl"},"Loading...",-1)]))):N("",!0),l.text?(C(),E("div",{key:1,class:T(["p-4 mb-4 rounded-md",l.type==="success"?"bg-green-100 text-green-700":l.type==="error"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"])},ee(l.text),3)):N("",!0),m("div",{class:T(["absolute adjust",{"mt-20":l.text}])},[m("div",le,[r(b,{type:"button",onClick:V,class:"m-1 ml-2 bg-navy p-10"},{default:i(()=>[r(K,{class:"h-5"})]),_:1}),r(b,{type:"button",onClick:t[0]||(t[0]=s=>j(f.journalid)),class:"m-1 ml-2 bg-navy p-10"},{default:i(()=>t[4]||(t[4]=[I(" GENERATE ")])),_:1}),r(b,{type:"button",onClick:G,class:"m-1 ml-2 bg-navy p-10"},{default:i(()=>[r(P,{class:"h-5"})]),_:1}),r(b,{type:"button",onClick:t[1]||(t[1]=s=>$(f.journalid)),class:"m-1 ml-2 bg-navy p-10"},{default:i(()=>[r(Q,{class:"h-5"})]),_:1}),r(b,{type:"button",onClick:t[2]||(t[2]=s=>H(f.journalid)),class:"m-1 bg-red-900"},{default:i(()=>t[5]||(t[5]=[I(" WAREHOUSE ")])),_:1})])],2),r(te(O),{data:f.inventjournaltransrepos,columns:A,class:"w-full relative display",options:M},{action:i(s=>t[6]||(t[6]=[m("label",{class:"inline-flex items-center"},[m("input",{type:"checkbox",class:"form-checkbox h-5 w-5 text-blue-600 rounded-full"}),m("span",{class:"ml-2 text-gray-700"})],-1)])),_:1},8,["data"])]),_:1})]),_:1}))}};export{Ee as default};
