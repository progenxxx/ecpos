import{d as m,k as A,l as S,G as F,c as R,w as g,o as w,a as s,e as _,b as c,f as E,j as x,v as b,u as U,N}from"./app-DwAHA_Mt.js";import{_ as T}from"./Main-CQ_whzxT.js";import{_ as C}from"./MultiSelectDropdown-CNaR8hG8.js";import{T as L}from"./TableContainer-PwYTmfDA.js";import{P as y,D as V}from"./dataTables-7Vvj0GSY.js";import"./buttons.print-CPkyJA-Y.js";import{E as B}from"./exceljs.min-Z3crVyW7.js";import"./Logout-96D5XcFa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-DosvBnh2.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-DsXaYi2t.js";import"./PartyCake143-DpGG8J3p.js";import"./Attendance-CVSU-1NF.js";const $={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},j={key:0,class:"flex-1 min-w-[200px]"},q={class:"flex-1 min-w-[200px]"},G={class:"flex-1 min-w-[200px]"},M={class:"flex items-end"},oe={__name:"Sales-2",props:{ar:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(i){y.use(V);const n=m([]),a=m(""),r=m(""),l=i;A(()=>{n.value=l.filters.selectedStores||[],a.value=l.filters.startDate||"",r.value=l.filters.endDate||""});const p=()=>{if(a.value&&r.value&&new Date(a.value)>new Date(r.value)){alert("Start date cannot be later than end date"),a.value="",r.value="";return}const o={startDate:a.value||null,endDate:r.value||null,stores:n.value.length>0?n.value:null};N.get(route("reports.sales"),o,{preserveState:!0,preserveScroll:!0})};let u;S([n,a,r],()=>{clearTimeout(u),u=setTimeout(p,500)},{deep:!0}),F(()=>{clearTimeout(u)});const D=[{data:"store",title:"Store"},{data:"total_netamount",title:"Net Amount",render:o=>`₱${parseFloat(o).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},{data:"total_discamount",title:"Discount Amount",render:o=>`₱${parseFloat(o).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},{data:"total_grossamount",title:"Gross Amount",render:o=>`₱${parseFloat(o).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}],k={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",buttons:["copy",{text:"Export Excel",action:function(o,e,t,f){h()}},"pdf","print"]},h=()=>{const o=new B.Workbook,e=o.addWorksheet("Sales Report");e.addRow(["Store","Net Amount","Discount Amount","Gross Amount"]),e.columns=[{header:"Store",key:"store",width:20},{header:"Net Amount",key:"netAmount",width:20,style:{numFmt:"#,##0.00"}},{header:"Discount Amount",key:"discountAmount",width:20,style:{numFmt:"#,##0.00"}},{header:"Gross Amount",key:"grossAmount",width:20,style:{numFmt:"#,##0.00"}}],l.ar.forEach(t=>{e.addRow({store:t.store,netAmount:t.total_netamount,discountAmount:t.total_discamount,grossAmount:t.total_grossamount})}),o.xlsx.writeBuffer().then(t=>{const f=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),v=window.URL.createObjectURL(f),d=document.createElement("a");d.href=v,d.download="sales_report.xlsx",d.click(),window.URL.revokeObjectURL(v)})};return(o,e)=>(w(),R(T,{"active-tab":"ORDER"},{main:g(()=>[s("div",$,[i.userRole.toUpperCase()==="ADMIN"||i.userRole.toUpperCase()==="SUPERADMIN"?(w(),_("div",j,[c(C,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),options:i.stores,label:"Stores"},null,8,["modelValue","options"])])):E("",!0),s("div",q,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(s("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=t=>a.value=t),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,a.value]])]),s("div",G,[e[5]||(e[5]=s("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(s("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=t=>r.value=t),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[b,r.value]])]),s("div",M,[s("button",{onClick:e[3]||(e[3]=()=>{n.value.value=[],a.value.value="",r.value.value="",p()}),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),c(L,null,{default:g(()=>[c(U(y),{data:l.ar,columns:D,class:"w-full relative display",options:k},null,8,["data"])]),_:1})]),_:1}))}};export{oe as default};
