import{T as B,H as L,s as c,D as E,d as x,p as V,c as R,w as p,o as N,b as n,a as o,i as Y,j as M,v as k,u,n as j}from"./app-D4KRJyko.js";import{_ as U}from"./AdminPanel-BwjEDCtJ.js";import{T as F}from"./TableContainer-BHVeCArx.js";import{P as D,D as H}from"./dataTables-BXgh5MYr.js";import{_ as z}from"./SuccessButton-B5RCiPM3.js";import{_ as P}from"./TransparentButton-DxOJ-9dG.js";import{_}from"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-5n6bCmaZ.js";import{P as q}from"./PartyCake143-Cp4Fa7fu.js";import{E as W}from"./Excel-Cx0Q9t9G.js";import{B as J}from"./Bread-DJxNviqK.js";import{S as X}from"./SearchColored-D1hwIAPK.js";import{E as K}from"./exceljs.min-4JhihTCQ.js";import"./RetailGroup-6t20PwtR.js";import"./Logout-8hw4reCp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-C1bDdoN8.js";import"./RetailItems-Dce1d_bp.js";import"./Attendance-DvpGN19-.js";const Q={class:"absolute adjust"},Z={class:"flex justify-start items-center"},tt=["value"],et={"date-rangepicker":"",class:"flex items-center"},rt={class:"relative ml-5"},at=["placeholder"],ot={class:"relative"},nt=["placeholder"],kt={__name:"MGCount copy",props:{orders:{type:Array,required:!0}},setup(O,{emit:st}){D.use(H);const S=O,s=B({StartDate:"",EndDate:""}),b=()=>{s.get(route("orderingconso.getrange"),{preserveScroll:!0})},I={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,error:function(t,e,a){console.error("DataTables error:",e)}},f=L(S.orders.reduce((t,e)=>{const{STORENAME:a,ITEMID:r,ITEMNAME:l,CATEGORY:d,COUNTED:m}=e,i=parseInt(m)||0;return t[r]||(t[r]={ITEMID:r,ITEMNAME:l,CATEGORY:d,TOTAL:0,MGCount:0,BalanceCount:0}),t[r][a]||(t[r][a]=0),t[r][a]+=i,t[r].TOTAL+=i,t[r].BalanceCount=t[r].TOTAL-t[r].MGCount,t},{})),y=c(()=>Object.values(f)),A=c(()=>{const t=new Set;return y.value.forEach(e=>{Object.keys(e).forEach(a=>{a!=="ITEMID"&&a!=="ITEMNAME"&&a!=="CATEGORY"&&a!=="TOTAL"&&a!=="MGCount"&&a!=="BalanceCount"&&t.add(a)})}),t}),g=c(()=>[{title:"ITEMID",data:"ITEMID"},{title:"ITEMS",data:"ITEMNAME"},{title:"CATEGORY",data:"CATEGORY"},{title:"TOTAL",data:"TOTAL"},{title:"ACTUAL INV COUNT",data:"MGCount",render:(t,e,a)=>e==="display"?`<input type="number" value="${t}" onchange="window.updateMGCount('${a.ITEMID}', this.value)" />`:t},{title:"BALANCECOUNT",data:"BalanceCount"},...Array.from(A.value).map(t=>({title:t,data:t,render:(e,a,r)=>a==="display"?`<input type="number" value="${e}" onchange="window.updateCounted('${r.ITEMID}', '${t}', this.value)" />`:e}))]);window.updateMGCount=function(t,e){const a=f[t];a&&(a.MGCount=parseInt(e,10)||0,a.BalanceCount=a.MGCount-a.TOTAL,E.post("/api/update-mgcount",{itemId:t,mgCount:a.MGCount}).then(r=>{console.log("MGCount updated successfully")}).catch(r=>{console.error("Error updating MGCount:",r)}))},window.updateCounted=function(t,e,a){const r=f[t];r&&(r[e]=parseInt(a,10)||0,r.TOTAL=Object.values(r).reduce((l,d)=>typeof d=="number"&&d!==r.MGCount&&d!==r.BalanceCount?l+d:l,0),r.BalanceCount=r.TOTAL-r.MGCount,E.post("/api/update-counted",{itemId:t,storeName:e,counted:r[e]}).then(l=>{console.log("Counted updated successfully")}).catch(l=>{console.error("Error updating Counted:",l)}))};const w=c(()=>y.value.map(t=>{const e={...t};return g.value.forEach(a=>{e.hasOwnProperty(a.data)||(e[a.data]="0")}),e})),C=x(null),v=c(()=>{if(C.value){const t=new Date(C.value),e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${r}`}return""}),T=x(null),h=c(()=>{if(T.value){const t=new Date(T.value),e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}-${a}-${r}`}return""});c(()=>{const t=new Date,e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${e}${a}${r}`});async function $(){try{const t=new K.Workbook,e=t.addWorksheet("Flattened Orders");e.columns=g.value.map(i=>({header:i.title,key:i.data,width:15})),w.value.forEach(i=>{e.addRow(i)});const a=new Date,r=`FlattenedOrders_${a.getFullYear()}-${a.getMonth()+1}-${a.getDate()}.xlsx`,l=await t.xlsx.writeBuffer(),d=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),m=document.createElement("a");m.href=URL.createObjectURL(d),m.download=r,m.click()}catch(t){console.error("Error exporting to Excel:",t)}}const G=()=>{window.location.href="/picklist"};return(t,e)=>{const a=V("InputError");return N(),R(U,{"active-tab":"REPORTS"},{main:p(()=>[n(F,null,{default:p(()=>[o("div",Q,[o("div",Z,[o("form",{onSubmit:Y(b,["prevent"]),class:"px-2 py-3 max-h-[50vh] lg:max-h-[70vh] overflow-y-auto"},[o("input",{type:"hidden",name:"_token",value:t.$page.props.csrf_token},null,8,tt),o("div",et,[o("div",rt,[e[4]||(e[4]=o("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[o("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[o("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),M(o("input",{id:"StartDate",type:"date","onUpdate:modelValue":e[0]||(e[0]=r=>u(s).StartDate=r),onInput:e[1]||(e[1]=(...r)=>v.value&&v.value(...r)),placeholder:v.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,at),[[k,u(s).StartDate]]),n(a,{message:u(s).errors.StartDate,class:"mt-2"},null,8,["message"])]),e[6]||(e[6]=o("span",{class:"mx-4 text-gray-500"},"to",-1)),o("div",ot,[e[5]||(e[5]=o("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[o("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[o("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),M(o("input",{id:"EndDate",type:"date","onUpdate:modelValue":e[2]||(e[2]=r=>u(s).EndDate=r),onInput:e[3]||(e[3]=(...r)=>h.value&&h.value(...r)),placeholder:h.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,nt),[[k,u(s).EndDate]]),n(a,{message:u(s).errors.EndDate,class:"mt-2"},null,8,["message"])])])],32),n(P,{type:"submit",onClick:b,disabled:u(s).processing,class:j({"opacity-25":u(s).processing})},{default:p(()=>[n(X,{class:"h-8"})]),_:1},8,["disabled","class"]),n(z,{type:"button",onClick:$,class:"m-6 bg-green"},{default:p(()=>[n(W,{class:"h-4"})]),_:1}),n(_,{type:"button",onClick:G,class:"m-1 bg-green"},{default:p(()=>[n(J,{class:"h-4"})]),_:1}),n(_,{type:"button",onClick:t.Cake,class:"m-1 bg-green"},{default:p(()=>[n(q,{class:"h-4"})]),_:1},8,["onClick"])])]),n(u(D),{data:w.value,columns:g.value,class:"w-full relative display",options:I},{action:p(r=>e[7]||(e[7]=[o("div",{class:"flex justify-start"},null,-1)])),_:1},8,["data","columns"])]),_:1})]),_:1})}}};export{kt as default};
