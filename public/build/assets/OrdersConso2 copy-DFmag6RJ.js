import{T as N,d as D,s as y,p as C,c as $,w as b,o as R,b as m,a as r,i as j,j as M,v as x,u,n as F,t as I}from"./app-NPxLYQzb.js";import{_ as V}from"./AdminPanel-wIY7u0qA.js";import{T as Y}from"./TableContainer-fwPJTGzy.js";import{P as O,D as L}from"./dataTables-B8uMeSpA.js";import{_ as B}from"./TransparentButton-9Q4xnQTP.js";import{_ as z}from"./SuccessButton-BNUgJNAf.js";import{S as H}from"./SearchColored-89nj1I8r.js";import{E as U}from"./Excel-Bqkg731v.js";import{E as q}from"./exceljs.min-DeYFmjAR.js";import"./RetailGroup-v8sjJEH1.js";import"./Logout-CsEENbA9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-LJRun7uo.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-COOUSa13.js";import"./RetailItems-DeQMtUxX.js";import"./Attendance-BB-OHPzQ.js";const G={class:"absolute adjust"},P={class:"flex justify-start items-center"},W=["value"],J={"date-rangepicker":"",class:"flex items-center"},X={class:"relative ml-5"},K=["placeholder"],Q={class:"relative"},Z=["placeholder"],tt={class:"font-bold text:navy"},et={props:{orders:{type:Array,required:!0}},computed:{flattenedOrders(){return this.calculateFlattenedOrders(this.orders)}},methods:{async exportToExcel(){try{const d=new q.Workbook,f=d.addWorksheet("Flattened Orders"),o=[{header:"ITEMID",key:"ITEMID",width:20},{header:"ITEMNAME",key:"ITEMNAME",width:25}],a=new Set;this.flattenedOrders.forEach(l=>{Object.keys(l).forEach(p=>{p!=="ITEMID"&&p!=="ITEMNAME"&&a.add(p)})}),a.forEach(l=>{o.push({header:l,key:l,width:20})}),f.columns=o,this.flattenedOrders.forEach(l=>{const p={ITEMID:l.ITEMID,ITEMNAME:l.ITEMNAME};a.forEach(g=>{p[g]=l[g]||0}),f.addRow(p)});const i=new Date,n=`FlattenedOrders_${i.getFullYear()}-${i.getMonth()+1}-${i.getDate()}.xlsx`,E=await d.xlsx.writeBuffer();this.saveExcelFile(E,n)}catch(d){console.error("Error exporting to Excel:",d)}},saveExcelFile(d,f){const o=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a");a.href=URL.createObjectURL(o),a.download=f,a.click()},calculateFlattenedOrders(d){const f=d.reduce((o,a)=>{const i=a.STORENAME,n=a.ITEMNAME;a.ITEMID;const E=parseInt(a.COUNTED.trim())||0;return o[n]||(o[n]={}),o[n][i]||(o[n][i]=0),o[n][i]+=E,o},{});return Object.entries(f).map(([o,a])=>{const i=d.find(n=>n.ITEMNAME===o);return{ITEMID:i?i.ITEMID:"",ITEMNAME:o,...Object.entries(a).reduce((n,[E,l])=>(n[E]=l,n),{})}})}}},vt=Object.assign(et,{__name:"OrdersConso2 copy",props:{orders:{type:Array,required:!0},startDate:String,endDate:String},setup(d,{emit:f}){O.use(L);const o=d,a=N({StartDate:"",EndDate:""}),i=()=>{a.get(route("orderingconso.getrange"),{preserveScroll:!0})},n={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,error:function(e,t,c){console.error("DataTables error:",t)}},E=o.orders.reduce((e,t)=>{const{STORENAME:c,ITEMID:s,ITEMNAME:h,CATEGORY:A,COUNTED:_}=t,w=parseInt(_.trim(),10)||0;return e[s]||(e[s]={ITEMID:s,ITEMNAME:h,CATEGORY:A,TOTAL:0}),e[s][c]||(e[s][c]=0),e[s][c]+=w,e[s].TOTAL+=w,e},{}),l=Object.values(E),p=[{title:"ITEMID",data:"ITEMID"},{title:"ITEMS",data:"ITEMNAME"},{title:"CATEGORY",data:"CATEGORY"},{title:"TOTAL",data:"TOTAL"}],g=new Set;l.forEach(e=>{Object.keys(e).forEach(t=>{t!=="ITEMID"&&t!=="ITEMNAME"&&t!=="CATEGORY"&&t!=="TOTAL"&&g.add(t)})}),g.forEach(e=>{p.push({title:e,data:e})}),l.forEach(e=>{p.forEach(t=>{e.hasOwnProperty(t.data)||(e[t.data]="0")})});const k=D(null),v=y(()=>{const e=u(k);if(e){const t=new Date(e),c=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),h=String(t.getDate()).padStart(2,"0");return`${c}-${s}-${h}`}return""}),S=D(null),T=y(()=>{const e=u(S);if(e){const t=new Date(e),c=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),h=String(t.getDate()).padStart(2,"0");return`${c}-${s}-${h}`}return""});return y(()=>{const e=new Date,t=e.getFullYear(),c=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}${c}${s}`}),(e,t)=>{const c=C("InputError");return R(),$(V,{"active-tab":"REPORTS"},{main:b(()=>[m(Y,null,{default:b(()=>[r("div",G,[r("div",P,[r("form",{onSubmit:j(i,["prevent"]),class:"px-2 py-3 max-h-[50vh] lg:max-h-[70vh] overflow-y-auto"},[r("input",{type:"hidden",name:"_token",value:e.$page.props.csrf_token},null,8,W),r("div",J,[r("div",X,[t[4]||(t[4]=r("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[r("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),M(r("input",{id:"StartDate",type:"date","onUpdate:modelValue":t[0]||(t[0]=s=>u(a).StartDate=s),onInput:t[1]||(t[1]=(...s)=>v.value&&v.value(...s)),placeholder:v.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,K),[[x,u(a).StartDate]]),m(c,{message:u(a).errors.StartDate,class:"mt-2"},null,8,["message"])]),t[6]||(t[6]=r("span",{class:"mx-4 text-gray-500"},"to",-1)),r("div",Q,[t[5]||(t[5]=r("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[r("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[r("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),M(r("input",{id:"EndDate",type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>u(a).EndDate=s),onInput:t[3]||(t[3]=(...s)=>T.value&&T.value(...s)),placeholder:T.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,Z),[[x,u(a).EndDate]]),m(c,{message:u(a).errors.EndDate,class:"mt-2"},null,8,["message"])])])],32),m(B,{type:"submit",onClick:i,disabled:u(a).processing,class:F({"opacity-25":u(a).processing})},{default:b(()=>[m(H,{class:"h-8"})]),_:1},8,["disabled","class"]),t[7]||(t[7]=r("details",{className:"dropdown"},[r("summary",{className:"btn m-1"},"RECENT"),r("ul",{className:"menu dropdown-content bg-base-100 rounded-box z-[1] w-52 p-2 shadow"},[r("li",null,[r("a",{href:"/lastmonth"},"Last Month")]),r("li",null,[r("a",{href:"/lastweek"},"Last Week")]),r("li",null,[r("a",{href:"/yesterday"},"Yesterday")])])],-1)),m(z,{type:"button",onClick:e.exportToExcel,class:"m-6 bg-green"},{default:b(()=>[m(U,{class:"h-4"})]),_:1},8,["onClick"]),r("h5",tt,I(d.startDate)+" | "+I(d.endDate),1)])]),m(u(O),{data:u(l),columns:p,class:"w-full relative display",options:n},{action:b(s=>t[8]||(t[8]=[r("div",{class:"flex justify-start"},null,-1)])),_:1},8,["data"])]),_:1})]),_:1})}}});export{vt as default};
