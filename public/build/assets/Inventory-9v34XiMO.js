import{q as A,d as c,l as Fe,E as De,k as Ee,c as P,w as re,B as Ae,o as l,a as t,e as r,t as a,j as T,v as M,i as $,F as G,h as Q,f as x,g as v,n as H,b as Me,u as Be,s as Le,N as Ve}from"./app-DIsI2h6N.js";import{_ as Ie}from"./AdminPanel-4mme3aov.js";import{_ as Oe}from"./Main-BuhnLEuc.js";import{T as Re}from"./TableContainer-BvhjGUIg.js";import{P as ie,D as Pe}from"./dataTables-CYg83-KT.js";import"./buttons.print-0974EdRm.js";import"./exceljs.min-BCSGA5zn.js";import{M as $e,C as He}from"./Close-DWDqPpWR.js";import"./RetailGroup-g15s03XT.js";import"./Logout-CSswU4gJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-DKCN2m9N.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-BHRlHpU4.js";import"./RetailItems-BxtVv693.js";import"./PartyCake143-D_7hneaj.js";const Ue={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow z-[999]"},ze={key:0,class:"flex-1 min-w-[200px] store-dropdown-container relative"},qe={class:"relative"},Je={key:0,class:"text-gray-500"},We={key:1},Ke={key:2},Xe={key:0,class:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto"},Ge={class:"p-2 border-b border-gray-200"},Qe={class:"max-h-40 overflow-auto"},Ye=["checked","onChange"],Ze={class:"text-sm"},et={key:0,class:"p-3 text-sm text-gray-500 text-center"},tt={class:"flex-1 min-w-[200px]"},st={class:"flex-1 min-w-[200px]"},ot={class:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md"},nt={class:"text-sm text-blue-800"},at={key:0},lt={class:"mb-4 bg-white rounded-lg shadow",open:""},rt={class:"p-4"},it={key:0,class:"flex justify-center items-center py-8"},dt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ut={class:"bg-gray-50 p-4 rounded-lg"},ct={class:"text-2xl mt-1"},mt={class:"bg-gray-50 p-4 rounded-lg"},vt={class:"text-2xl mt-1"},pt={class:"bg-gray-50 p-4 rounded-lg"},gt={class:"text-2xl mt-1"},xt={class:"bg-gray-50 p-4 rounded-lg"},yt={class:"flex justify-between mt-1"},bt={class:"text-lg"},ft={class:"text-lg"},wt={class:"bg-gray-50 p-4 rounded-lg"},ht={class:"text-2xl mt-1"},_t={class:"bg-gray-50 p-4 rounded-lg"},kt={class:"text-2xl mt-1"},jt={class:"bg-gray-50 p-4 rounded-lg"},Nt={class:"text-2xl mt-1 font-bold"},Tt={class:"bg-gray-50 p-4 rounded-lg col-span-1"},St={class:"flex justify-between mt-1"},Ct={class:"text-xl text-red-600"},Ft={class:"text-xl text-green-600"},Dt={class:"bg-gray-50 p-4 rounded-lg col-span-full"},Et={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},At={class:"text-lg"},Mt={class:"text-lg"},Bt={class:"text-lg"},Lt={class:"text-lg"},Vt={class:"text-lg"},It={class:"bg-white rounded-lg shadow"},Ot={key:0,class:"flex justify-center items-center py-12"},Rt={key:1,class:"overflow-hidden"},Pt={class:"max-h-96 overflow-y-auto"},$t=["onTouchstart","onTouchend","onMousedown","onMouseup"],Ht={class:"space-y-3"},Ut={class:"font-medium text-gray-900"},zt={class:"text-sm text-gray-500"},qt={class:"grid grid-cols-2 gap-2 text-sm"},Jt={class:"font-medium ml-1"},Wt={class:"font-medium ml-1"},Kt={class:"font-medium ml-1"},Xt={class:"font-medium ml-1"},Gt={class:"font-bold ml-1"},Qt={class:"grid grid-cols-3 gap-2 text-xs text-gray-600"},Yt={class:"flex justify-end space-x-2 mt-2"},Zt=["onClick"],es=["onClick"],ts={key:0,class:"fixed bottom-6 right-6 z-40"},ss={key:0,class:"absolute bottom-16 right-0 bg-white rounded-lg shadow-lg border border-gray-200 py-2 w-56 transform transition-all duration-200 ease-out"},os={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ns={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},as={class:"mt-3"},ls={key:0,class:"mb-4 p-3 bg-gray-50 rounded"},rs={class:"text-sm font-medium"},is={class:"text-sm text-gray-600"},ds={class:"text-sm text-gray-600"},us={class:"text-xs text-gray-500"},cs={class:"space-y-4"},ms={class:"block text-sm font-medium text-gray-700"},vs={key:0},ps={key:1},gs={key:2},xs={key:0,class:"p-3 bg-blue-50 rounded"},ys={class:"text-sm text-blue-700"},bs={key:0},fs={key:1},ws={class:"flex justify-end space-x-3 mt-6"},hs=["disabled"],_s=["disabled"],ks={key:0},js={key:1},Ns={key:3,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Ts={class:"relative top-10 mx-auto p-5 border w-4/5 max-w-4xl shadow-lg rounded-md bg-white"},Ss={class:"mt-3"},Cs={key:0,class:"mb-4 p-3 bg-gray-50 rounded"},Fs={class:"text-sm font-medium"},Ds={class:"text-sm text-gray-600"},Es={key:1,class:"flex justify-center items-center py-8"},As={key:2,class:"text-center py-8 text-gray-500"},Ms={key:3,class:"overflow-x-auto"},Bs={class:"min-w-full divide-y divide-gray-200"},Ls={class:"bg-white divide-y divide-gray-200"},Vs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Is={class:"px-6 py-4 whitespace-nowrap text-sm"},Os={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Rs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Ps={key:0},$s={key:1},Hs={class:"px-6 py-4 text-sm text-gray-900"},Us=["title"],zs={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ro={__name:"Inventory",props:{inventory:{type:Array,required:!0,default:()=>[]},stores:{type:Array,required:!0,default:()=>[]},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})},url:{type:String,default:()=>route("reports.inventory")}},setup(S){ie.use(Pe);const m=S,de=A(()=>m.userRole.toUpperCase()==="STORE"?Oe:Ie),p=c(m.filters.selectedStores||[]),b=c(m.filters.startDate||""),f=c(m.filters.endDate||""),h=c(!0),_=c(!1),B=c(!1),L=c(null),C=c(0),F=c(null),j=c(!1),V=c(""),k=c(!1),Y=A(()=>{let o=[];return Array.isArray(m.stores)&&(o=m.stores.map(e=>{if(typeof e=="object"&&e!==null){if(e.NAME)return e.NAME;if(e.name)return e.name;if(e.storename)return e.storename;if(e.store_name)return e.store_name;const s=JSON.stringify(e),n=s.match(/"NAME"\s*:\s*"([^"]+)"/);return n?n[1]:s.replace(/[{}":]/g,"").replace(/STOREID[^,]*,?\s*/g,"").replace(/NAME/g,"").trim()||"Unknown Store"}return String(e)})),V.value?o.filter(e=>e.toLowerCase().includes(V.value.toLowerCase())):o}),U=c(!1),u=c(null),i=c({adjustment_value:"",adjustment_type:"set",remarks:""}),D=c(!1),z=c(!1),I=c([]),q=c(!1),Z=o=>{clearTimeout(L.value),C.value++,C.value===1?L.value=setTimeout(()=>{C.value=0},300):C.value===2&&(clearTimeout(L.value),O(o),C.value=0)},ue=(o,e)=>{j.value=!1,F.value=setTimeout(()=>{j.value=!0,E(o),navigator.vibrate&&navigator.vibrate(50)},1e3)},ce=(o,e)=>{clearTimeout(F.value),j.value||Z(o)},me=(o,e)=>{e.preventDefault(),j.value=!1,F.value=setTimeout(()=>{j.value=!0,E(o)},1e3)},ve=(o,e)=>{clearTimeout(F.value),j.value||Z(o)},J=()=>{clearTimeout(F.value),clearTimeout(L.value)},pe=()=>{_.value=!_.value},w=()=>{_.value=!1},ge=o=>{const e=p.value.indexOf(o);e>-1?p.value.splice(e,1):p.value.push(o)},xe=o=>p.value.includes(o),ye=()=>{p.value=[],k.value=!1},be=()=>{const o=m.stores.map(e=>{if(typeof e=="object"&&e!==null){if(e.NAME)return e.NAME;if(e.name)return e.name;if(e.storename)return e.storename;if(e.store_name)return e.store_name;const s=JSON.stringify(e),n=s.match(/"NAME"\s*:\s*"([^"]+)"/);return n?n[1]:s.replace(/[{}":]/g,"").replace(/STOREID[^,]*,?\s*/g,"").replace(/NAME/g,"").trim()||"Unknown Store"}return String(e)});p.value=o,k.value=!1},W=()=>{B.value=window.innerWidth<768},y=A(()=>{var o;return(o=m.inventory)!=null&&o.length?m.inventory.reduce((e,s)=>{const n=g=>Number(g||0),d=n(s.throw_away)+n(s.early_molds)+n(s.pull_out)+n(s.rat_bites)+n(s.ant_bites);return{beginning:e.beginning+n(s.beginning),receivedDelivery:e.receivedDelivery+n(s.received_delivery),stockTransfer:e.stockTransfer+n(s.stock_transfer),sales:e.sales+n(s.sales),bundleSales:e.bundleSales+n(s.bundle_sales||0),waste:e.waste+d,itemcount:e.itemcount+n(s.item_count),ending:e.ending+n(s.ending),variance:e.variance+n(s.variance),throwAway:e.throwAway+n(s.throw_away),earlyMolds:e.earlyMolds+n(s.early_molds),pullOut:e.pullOut+n(s.pull_out),ratBites:e.ratBites+n(s.rat_bites),antBites:e.antBites+n(s.ant_bites)}},{beginning:0,receivedDelivery:0,stockTransfer:0,sales:0,bundleSales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0}):{beginning:0,receivedDelivery:0,stockTransfer:0,sales:0,bundleSales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0}}),fe=A(()=>{var o;return((o=m.inventory)==null?void 0:o.reduce((e,s)=>{const n=Number(s.variance||0);return n<0?e+n:e},0))||0}),we=A(()=>{var o;return((o=m.inventory)==null?void 0:o.reduce((e,s)=>{const n=Number(s.variance||0);return n>0?e+n:e},0))||0}),O=o=>{console.log("Opening adjustment modal for item:",o),u.value=o,i.value={adjustment_value:"",adjustment_type:"set",remarks:""},U.value=!0,w()},ee=()=>{U.value=!1,u.value=null,i.value={adjustment_value:"",adjustment_type:"set",remarks:""}},he=async()=>{var o;if(!i.value.adjustment_value||!i.value.remarks.trim()){alert("Please fill in all required fields");return}if(!u.value||!u.value.id){alert("Item ID is missing. This might be an aggregated record. Please contact support if this persists."),console.error("Missing ID for item:",u.value);return}D.value=!0;try{const e=(o=document.querySelector('meta[name="csrf-token"]'))==null?void 0:o.getAttribute("content");if(!e)throw new Error("CSRF token not found");const s={id:u.value.id,adjustment_value:parseFloat(i.value.adjustment_value),adjustment_type:i.value.adjustment_type,remarks:i.value.remarks.trim()};console.log("Submitting adjustment:",s);const n=await fetch("/inventory/adjust-item-count",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":e,Accept:"application/json"},body:JSON.stringify(s)});if(!n.ok){const g=await n.text();throw console.error("HTTP Error Response:",g),new Error(`HTTP error! status: ${n.status} - ${g}`)}const d=await n.json();console.log("Response:",d),d.success?(alert("Item count adjusted successfully"),ee(),window.location.reload()):(alert(d.message||"Failed to adjust item count"),d.errors&&(console.error("Validation errors:",d.errors),Object.keys(d.errors).forEach(g=>{console.error(`${g}: ${d.errors[g].join(", ")}`)})))}catch(e){console.error("Error adjusting item count:",e),alert("An error occurred while adjusting item count: "+e.message)}finally{D.value=!1}},E=async o=>{var e;u.value=o,z.value=!0,q.value=!0,w();try{const s=(e=document.querySelector('meta[name="csrf-token"]'))==null?void 0:e.getAttribute("content"),d=await(await fetch("/inventory/adjustment-history",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":s,Accept:"application/json"},body:JSON.stringify({itemid:o.itemid,storename:o.storename})})).json();d.success?I.value=d.data:console.error("Failed to fetch adjustment history:",d.message)}catch(s){console.error("Error fetching adjustment history:",s)}finally{q.value=!1}},_e=()=>{z.value=!1,u.value=null,I.value=[]},ke=[{data:"itemname",title:"Item Name",className:"min-w-[200px]"},{data:"storename",title:"Store",className:"min-w-[120px]"},{data:"beginning",title:"Beginning",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"received_delivery",title:"Received",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"stock_transfer",title:"Stock Transfer",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"sales",title:"Direct Sales",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"bundle_sales",title:"Bundle Sales",className:"text-right",render:(o,e,s)=>Number(s.bundle_sales||0).toFixed(2)},{data:"throw_away",title:"Throw Away",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"early_molds",title:"Early Molds",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"pull_out",title:"Pull Out",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"rat_bites",title:"Rat Bites",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"ant_bites",title:"Ant Bites",className:"text-right",render:o=>Number(o||0).toFixed(2)},{data:"item_count",title:"Item Count",className:"text-right",render:(o,e,s)=>{const n=Number(o||0).toFixed(2),d=`adjust-${s.id||Math.random()}`,g=`history-${s.id||Math.random()}`;return`
                <div class="flex items-center justify-between">
                    <span>${n}</span>
                    <div class="flex gap-1 ml-2">
                        <button 
                            id="${d}"
                            class="text-blue-600 hover:text-blue-800 text-xs px-2 py-1 border border-blue-300 rounded adjust-btn"
                            title="Adjust Item Count"
                            data-item='${JSON.stringify(s)}'
                        >
                            Adjust
                        </button>
                        <button 
                            id="${g}"
                            class="text-green-600 hover:text-green-800 text-xs px-2 py-1 border border-green-300 rounded history-btn"
                            title="View History"
                            data-item='${JSON.stringify(s)}'
                        >
                            History
                        </button>
                    </div>
                </div>
            `}},{data:"ending",title:"Ending",className:"text-right font-bold",render:o=>Number(o||0).toFixed(2)},{data:"variance",title:"Variance",className:"text-right",render:(o,e,s)=>{const n=Number(o||0);return`<span class="${n<0?"text-red-600":"text-green-600"} font-bold">${n.toFixed(2)}</span>`}}],te=()=>{document.removeEventListener("click",K),document.addEventListener("click",K)},K=o=>{if(o.target.classList.contains("adjust-btn")){const e=JSON.parse(o.target.getAttribute("data-item"));O(e)}else if(o.target.classList.contains("history-btn")){const e=JSON.parse(o.target.getAttribute("data-item"));E(e)}},je={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",deferRender:!0,buttons:["copy",{extend:"csv",title:"Inventory Report"},{extend:"excel",title:"Inventory Report"},{extend:"pdf",title:"Inventory Report"},"print"],createdRow:function(o,e,s){let n,d=0,g;o.classList.add("cursor-pointer","hover:bg-gray-50","select-none");const ae=N=>{N.preventDefault(),n=setTimeout(()=>{E(e)},1e3)},R=()=>{clearTimeout(n)},le=N=>{N.target.classList.contains("adjust-btn")||N.target.classList.contains("history-btn")||N.target.closest(".adjust-btn")||N.target.closest(".history-btn")||(clearTimeout(g),d++,d===1?g=setTimeout(()=>{d=0},300):d===2&&(clearTimeout(g),O(e),d=0))};o.addEventListener("mousedown",ae),o.addEventListener("mouseup",R),o.addEventListener("mouseleave",R),o.addEventListener("click",le),o._cleanupEvents=()=>{o.removeEventListener("mousedown",ae),o.removeEventListener("mouseup",R),o.removeEventListener("mouseleave",R),o.removeEventListener("click",le),clearTimeout(n),clearTimeout(g)}},drawCallback:function(){h.value=!1,setTimeout(te,100)}},se=()=>{if(b.value&&f.value){const o=new Date(b.value),e=new Date(f.value);if(o>e){alert("Start date cannot be later than end date");return}}h.value=!0,Ve.get(route("reports.inventory"),{startDate:b.value,endDate:f.value,stores:p.value},{preserveState:!0,preserveScroll:!0,onSuccess:()=>{h.value=!1},onError:o=>{console.error("Filter update failed:",o),h.value=!1}})},oe=()=>{p.value=[],b.value="",f.value="",se(),w()},Ne=()=>{if(window.DataTable){const o=window.DataTable.tables()[0];o&&o.button(".buttons-csv").trigger()}w()},Te=()=>{if(window.DataTable){const o=window.DataTable.tables()[0];o&&o.button(".buttons-excel").trigger()}w()},Se=()=>{if(window.DataTable){const o=window.DataTable.tables()[0];o&&o.button(".buttons-pdf").trigger()}w()},Ce=()=>{if(window.DataTable){const o=window.DataTable.tables()[0];o&&o.button(".buttons-print").trigger()}w()},ne=o=>{k.value&&!o.target.closest(".store-dropdown-container")&&(k.value=!1)};let X;return Fe([p,b,f],()=>{clearTimeout(X),X=setTimeout(se,500)},{deep:!0}),De(()=>{clearTimeout(X),J(),document.removeEventListener("click",K),document.removeEventListener("click",ne),window.removeEventListener("resize",W)}),Ee(()=>{p.value=m.filters.selectedStores||[],b.value=m.filters.startDate||"",f.value=m.filters.endDate||"",console.log("Inventory data:",m.inventory),te(),document.addEventListener("click",ne),window.addEventListener("resize",W),W(),setTimeout(()=>{h.value=!1},500)}),(o,e)=>(l(),P(Ae(de.value),{"active-tab":"REPORTS"},{main:re(()=>[t("div",Ue,[S.userRole.toUpperCase()==="ADMIN"||S.userRole.toUpperCase()==="SUPERADMIN"?(l(),r("div",ze,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Stores",-1)),t("div",qe,[t("button",{onClick:e[0]||(e[0]=s=>k.value=!k.value),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-left bg-white"},[p.value.length===0?(l(),r("span",Je,"Select stores...")):p.value.length===1?(l(),r("span",We,a(p.value[0]),1)):(l(),r("span",Ke,a(p.value.length)+" stores selected",1)),e[9]||(e[9]=t("svg",{class:"float-right mt-1 h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),k.value?(l(),r("div",Xe,[t("div",Ge,[T(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s),type:"text",placeholder:"Search stores...",class:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",onClick:e[2]||(e[2]=$(()=>{},["stop"]))},null,512),[[M,V.value]])]),t("div",{class:"p-2 border-b border-gray-200 flex gap-2"},[t("button",{onClick:be,class:"px-3 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600"}," Select All "),t("button",{onClick:ye,class:"px-3 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600"}," Clear ")]),t("div",Qe,[(l(!0),r(G,null,Q(Y.value,s=>(l(),r("label",{key:s,class:"flex items-center px-3 py-2 hover:bg-gray-100 cursor-pointer"},[t("input",{type:"checkbox",checked:xe(s),onChange:n=>ge(s),class:"mr-2 form-checkbox h-4 w-4 text-blue-600"},null,40,Ye),t("span",Ze,a(s),1)]))),128))]),Y.value.length===0?(l(),r("div",et," No stores found ")):x("",!0)])):x("",!0)])])):x("",!0),t("div",tt,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),T(t("input",{type:"date","onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,b.value]])]),t("div",st,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),T(t("input",{type:"date","onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[M,f.value]])]),t("div",{class:"flex items-end"},[t("button",{onClick:oe,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),t("div",ot,[t("p",nt,[e[14]||(e[14]=t("strong",null,"Interaction Guide:",-1)),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=v(" • ")),e[17]||(e[17]=t("strong",null,"Hold/Long press 1 second:",-1)),e[18]||(e[18]=v(" View adjustment history")),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=v(" • ")),e[21]||(e[21]=t("strong",null,"Double click/tap:",-1)),e[22]||(e[22]=v(" Adjust item count")),e[23]||(e[23]=t("br",null,null,-1)),e[24]||(e[24]=v(" • ")),e[25]||(e[25]=t("strong",null,"Single click buttons:",-1)),e[26]||(e[26]=v(" Direct actions")),e[27]||(e[27]=t("br",null,null,-1)),B.value?(l(),r("span",at,e[13]||(e[13]=[v("• "),t("strong",null,"Use floating menu",-1),v(" for exports and filters")]))):x("",!0)])]),t("details",lt,[e[47]||(e[47]=t("summary",{class:"px-4 py-3 text-lg font-medium cursor-pointer"}," Inventory Summary ",-1)),t("div",rt,[h.value?(l(),r("div",it,e[28]||(e[28]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"},null,-1),t("span",{class:"ml-3"},"Loading data...",-1)]))):(l(),r("div",dt,[t("div",ut,[e[29]||(e[29]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Beginning Balance",-1)),t("p",ct,a(y.value.beginning.toFixed(2)),1)]),t("div",mt,[e[30]||(e[30]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Received",-1)),t("p",vt,a(y.value.receivedDelivery.toFixed(2)),1)]),t("div",pt,[e[31]||(e[31]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Stock Transfer",-1)),t("p",gt,a(y.value.stockTransfer.toFixed(2)),1)]),t("div",xt,[e[34]||(e[34]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Sales",-1)),t("div",yt,[t("div",null,[e[32]||(e[32]=t("span",{class:"text-sm text-gray-500"},"Direct:",-1)),t("p",bt,a(y.value.sales.toFixed(2)),1)]),t("div",null,[e[33]||(e[33]=t("span",{class:"text-sm text-gray-500"},"Bundle:",-1)),t("p",ft,a(y.value.bundleSales.toFixed(2)),1)])])]),t("div",wt,[e[35]||(e[35]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Waste",-1)),t("p",ht,a(y.value.waste.toFixed(2)),1)]),t("div",_t,[e[36]||(e[36]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Current Count",-1)),t("p",kt,a(y.value.itemcount.toFixed(2)),1)]),t("div",jt,[e[37]||(e[37]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Ending Balance",-1)),t("p",Nt,a(y.value.ending.toFixed(2)),1)]),t("div",Tt,[e[40]||(e[40]=t("h3",{class:"text-sm font-semibold text-gray-600"},"Total Variance",-1)),t("div",St,[t("div",null,[e[38]||(e[38]=t("span",{class:"text-sm text-gray-500"},"Negative:",-1)),t("p",Ct,a(fe.value.toFixed(2)),1)]),t("div",null,[e[39]||(e[39]=t("span",{class:"text-sm text-gray-500"},"Positive:",-1)),t("p",Ft,a(we.value.toFixed(2)),1)])])]),t("div",Dt,[e[46]||(e[46]=t("h3",{class:"text-sm font-semibold text-gray-600 mb-2"},"Waste Breakdown",-1)),t("div",Et,[t("div",null,[e[41]||(e[41]=t("p",{class:"text-xs text-gray-500"},"Throw Away",-1)),t("p",At,a(y.value.throwAway.toFixed(2)),1)]),t("div",null,[e[42]||(e[42]=t("p",{class:"text-xs text-gray-500"},"Early Molds",-1)),t("p",Mt,a(y.value.earlyMolds.toFixed(2)),1)]),t("div",null,[e[43]||(e[43]=t("p",{class:"text-xs text-gray-500"},"Pull Out",-1)),t("p",Bt,a(y.value.pullOut.toFixed(2)),1)]),t("div",null,[e[44]||(e[44]=t("p",{class:"text-xs text-gray-500"},"Rat Bites",-1)),t("p",Lt,a(y.value.ratBites.toFixed(2)),1)]),t("div",null,[e[45]||(e[45]=t("p",{class:"text-xs text-gray-500"},"Ant Bites",-1)),t("p",Vt,a(y.value.antBites.toFixed(2)),1)])])])]))])]),t("div",It,[h.value?(l(),r("div",Ot,e[48]||(e[48]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-indigo-500"},null,-1),t("span",{class:"ml-4 text-lg"},"Loading inventory data...",-1)]))):x("",!0),B.value?(l(),r("div",Rt,[t("div",Pt,[(l(!0),r(G,null,Q(S.inventory,s=>(l(),r("div",{key:`${s.itemid}-${s.storename}`,class:"border-b border-gray-200 p-4 hover:bg-gray-50 transition-colors select-none cursor-pointer",onTouchstart:n=>ue(s,n),onTouchend:n=>ce(s,n),onTouchcancel:J,onMousedown:n=>me(s,n),onMouseup:n=>ve(s,n),onMouseleave:J,onContextmenu:e[5]||(e[5]=$(()=>{},["prevent"]))},[t("div",Ht,[t("div",null,[t("div",Ut,a((s==null?void 0:s.itemname)||""),1),t("div",zt,a((s==null?void 0:s.storename)||""),1)]),t("div",qt,[t("div",null,[e[49]||(e[49]=t("span",{class:"text-gray-600"},"Beginning:",-1)),t("span",Jt,a(Number((s==null?void 0:s.beginning)||0).toFixed(2)),1)]),t("div",null,[e[50]||(e[50]=t("span",{class:"text-gray-600"},"Received:",-1)),t("span",Wt,a(Number((s==null?void 0:s.received_delivery)||0).toFixed(2)),1)]),t("div",null,[e[51]||(e[51]=t("span",{class:"text-gray-600"},"Sales:",-1)),t("span",Kt,a(Number((s==null?void 0:s.sales)||0).toFixed(2)),1)]),t("div",null,[e[52]||(e[52]=t("span",{class:"text-gray-600"},"Item Count:",-1)),t("span",Xt,a(Number((s==null?void 0:s.item_count)||0).toFixed(2)),1)]),t("div",null,[e[53]||(e[53]=t("span",{class:"text-gray-600"},"Ending:",-1)),t("span",Gt,a(Number((s==null?void 0:s.ending)||0).toFixed(2)),1)]),t("div",null,[e[54]||(e[54]=t("span",{class:"text-gray-600"},"Variance:",-1)),t("span",{class:H(["font-bold ml-1",Number((s==null?void 0:s.variance)||0)<0?"text-red-600":"text-green-600"])},a(Number((s==null?void 0:s.variance)||0).toFixed(2)),3)])]),t("div",Qt,[t("div",null,"Throw Away: "+a(Number((s==null?void 0:s.throw_away)||0).toFixed(2)),1),t("div",null,"Early Molds: "+a(Number((s==null?void 0:s.early_molds)||0).toFixed(2)),1),t("div",null,"Pull Out: "+a(Number((s==null?void 0:s.pull_out)||0).toFixed(2)),1)]),t("div",Yt,[t("button",{onClick:$(n=>O(s),["stop"]),class:"text-blue-600 hover:text-blue-900 text-sm px-2 py-1 border border-blue-300 rounded"}," Adjust ",8,Zt),t("button",{onClick:$(n=>E(s),["stop"]),class:"text-green-600 hover:text-green-900 text-sm px-2 py-1 border border-green-300 rounded"}," History ",8,es)])])],40,$t))),128))])])):(l(),P(Re,{key:2,class:"max-h-[80vh] overflow-x-auto overflow-y-auto"},{default:re(()=>[e[55]||(e[55]=t("div",{class:"p-4 bg-gray-50 border-b border-gray-200"},[t("p",{class:"text-sm text-gray-600"},[t("strong",null,"Desktop Interactions:"),v(" Hold any row for 1 second to view adjustment history, or double-click to adjust item count. ")])],-1)),Me(Be(ie),{data:S.inventory,columns:ke,class:"w-full relative display",options:je},null,8,["data"])]),_:1}))]),B.value?(l(),r("div",ts,[_.value?(l(),r("div",ss,[e[61]||(e[61]=t("div",{class:"px-4 py-2 border-b border-gray-200"},[t("p",{class:"text-sm font-medium text-gray-700"},"Export Data")],-1)),t("button",{onClick:Ne,class:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"},e[56]||(e[56]=[t("svg",{class:"h-4 w-4 mr-3 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Export CSV ")])),t("button",{onClick:Te,class:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"},e[57]||(e[57]=[t("svg",{class:"h-4 w-4 mr-3 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Export Excel ")])),t("button",{onClick:Se,class:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"},e[58]||(e[58]=[t("svg",{class:"h-4 w-4 mr-3 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),v(" Export PDF ")])),t("button",{onClick:Ce,class:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"},e[59]||(e[59]=[t("svg",{class:"h-4 w-4 mr-3 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})],-1),v(" Print Report ")])),e[62]||(e[62]=t("div",{class:"border-t border-gray-200 my-2"},null,-1)),t("button",{onClick:oe,class:"w-full px-4 py-3 text-left text-sm text-gray-700 hover:bg-gray-100 flex items-center"},e[60]||(e[60]=[t("svg",{class:"h-4 w-4 mr-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.414A1 1 0 013 6.707V4z"})],-1),v(" Clear All Filters ")]))])):x("",!0),t("button",{onClick:pe,class:H(["bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transition-all duration-200 ease-out transform hover:scale-105",{"rotate-45":_.value}])},[_.value?(l(),P(He,{key:1,class:"h-6 w-6"})):(l(),P($e,{key:0,class:"h-6 w-6"}))],2)])):x("",!0),_.value?(l(),r("div",{key:1,onClick:w,class:"fixed inset-0 bg-black bg-opacity-25 z-30"})):x("",!0),U.value?(l(),r("div",os,[t("div",ns,[t("div",as,[e[66]||(e[66]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Adjust Item Count ",-1)),u.value?(l(),r("div",ls,[t("p",rs,a(u.value.itemname),1),t("p",is,"Store: "+a(u.value.storename),1),t("p",ds,"Current Count: "+a(Number(u.value.item_count||0).toFixed(2)),1),t("p",us,"ID: "+a(u.value.id||"No ID"),1)])):x("",!0),t("div",cs,[t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-medium text-gray-700"},"Adjustment Type",-1)),T(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>i.value.adjustment_type=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[63]||(e[63]=[t("option",{value:"set"},"Set to Value",-1),t("option",{value:"add"},"Add to Current",-1),t("option",{value:"subtract"},"Subtract from Current",-1)]),512),[[Le,i.value.adjustment_type]])]),t("div",null,[t("label",ms,[i.value.adjustment_type==="set"?(l(),r("span",vs,"New Value")):i.value.adjustment_type==="add"?(l(),r("span",ps,"Amount to Add")):(l(),r("span",gs,"Amount to Subtract"))]),T(t("input",{type:"number",step:"0.01","onUpdate:modelValue":e[7]||(e[7]=s=>i.value.adjustment_value=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Enter value",required:""},null,512),[[M,i.value.adjustment_value]])]),t("div",null,[e[65]||(e[65]=t("label",{class:"block text-sm font-medium text-gray-700"},"Remarks *",-1)),T(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>i.value.remarks=s),rows:"3",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Reason for adjustment (required)",required:""},null,512),[[M,i.value.remarks]])]),i.value.adjustment_type!=="set"&&i.value.adjustment_value&&u.value?(l(),r("div",xs,[t("p",ys,[i.value.adjustment_type==="add"?(l(),r("span",bs," New value will be: "+a((Number(u.value.item_count||0)+Number(i.value.adjustment_value||0)).toFixed(2)),1)):(l(),r("span",fs," New value will be: "+a((Number(u.value.item_count||0)-Number(i.value.adjustment_value||0)).toFixed(2)),1))])])):x("",!0)]),t("div",ws,[t("button",{onClick:ee,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",disabled:D.value}," Cancel ",8,hs),t("button",{onClick:he,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-blue-300",disabled:D.value||!i.value.adjustment_value||!i.value.remarks.trim()},[D.value?(l(),r("span",ks,"Processing...")):(l(),r("span",js,"Apply Adjustment"))],8,_s)])])])])):x("",!0),z.value?(l(),r("div",Ns,[t("div",Ts,[t("div",Ss,[e[69]||(e[69]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"}," Adjustment History ",-1)),u.value?(l(),r("div",Cs,[t("p",Fs,a(u.value.itemname),1),t("p",Ds,"Store: "+a(u.value.storename),1)])):x("",!0),q.value?(l(),r("div",Es,e[67]||(e[67]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-500"},null,-1),t("span",{class:"ml-3"},"Loading history...",-1)]))):I.value.length===0?(l(),r("div",As," No adjustment history found for this item. ")):(l(),r("div",Ms,[t("table",Bs,[e[68]||(e[68]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Old Value"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"New Value"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Adjustment"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Remarks"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Adjusted By")])],-1)),t("tbody",Ls,[(l(!0),r(G,null,Q(I.value,s=>(l(),r("tr",{key:s.id},[t("td",Vs,a(new Date(s.created_at).toLocaleString()),1),t("td",Is,[t("span",{class:H(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",{"bg-blue-100 text-blue-800":s.adjustment_type==="set","bg-green-100 text-green-800":s.adjustment_type==="add","bg-red-100 text-red-800":s.adjustment_type==="subtract"}])},a(s.adjustment_type.toUpperCase()),3)]),t("td",Os,a(Number(s.old_item_count).toFixed(2)),1),t("td",Rs,a(Number(s.new_item_count).toFixed(2)),1),t("td",{class:H(["px-6 py-4 whitespace-nowrap text-sm",{"text-green-600":s.adjustment_type==="add"||s.adjustment_type==="set"&&s.new_item_count>s.old_item_count,"text-red-600":s.adjustment_type==="subtract"||s.adjustment_type==="set"&&s.new_item_count<s.old_item_count}])},[s.adjustment_type==="add"?(l(),r("span",Ps,"+")):s.adjustment_type==="subtract"?(l(),r("span",$s,"-")):x("",!0),v(" "+a(Number(s.adjustment_value).toFixed(2)),1)],2),t("td",Hs,[t("div",{class:"max-w-xs truncate",title:s.remarks},a(s.remarks),9,Us)]),t("td",zs,a(s.adjusted_by_name||"Unknown"),1)]))),128))])])])),t("div",{class:"flex justify-end mt-6"},[t("button",{onClick:_e,class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400"}," Close ")])])])])):x("",!0)]),_:1}))}};export{ro as default};
