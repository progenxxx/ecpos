import{d as m,k as R,q as y,l as C,E as S,c as _,w as c,o as u,a,e as f,b as g,f as k,j as x,v as D,h as N,t as b,F as O,u as V,N as B}from"./app-DIsI2h6N.js";import{_ as L}from"./Main-BuhnLEuc.js";import{_ as U}from"./MultiSelectDropdown-B9XsDNK4.js";import{T as q}from"./TableContainer-BvhjGUIg.js";import{P as F,D as M}from"./dataTables-CYg83-KT.js";import"./Logout-CSswU4gJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-DKCN2m9N.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-BHRlHpU4.js";import"./PartyCake143-D_7hneaj.js";const P={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},Y={key:0,class:"flex-1 min-w-[200px]"},G={class:"flex-1 min-w-[200px]"},I={class:"flex-1 min-w-[200px]"},j={class:"flex items-end"},H={class:"collapse collapse-plus bg-gray-100 rounded-none"},$={class:"collapse-content"},X={class:"mb-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},z={class:"text-sm font-medium text-gray-500 uppercase"},J={class:"mt-1 text-lg font-semibold"},ne={__name:"BadOrder",props:{ar:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(d){F.use(M);const s=m([]),o=m(""),l=m(""),i=d;R(()=>{s.value=i.filters.selectedStores||[],o.value=i.filters.startDate||"",l.value=i.filters.endDate||""});const v=y(()=>{let e=[...i.ar];return s.value.length>0&&(e=e.filter(t=>s.value.includes(t.storename))),o.value&&l.value&&(e=e.filter(t=>{const r=new Date(t.createddate),n=new Date(o.value),E=new Date(l.value);return r>=n&&r<=E})),e}),w=[{data:"storename",title:"STORE"},{data:"receiptid",title:"RECEIPT"},{data:"createddate",title:"CREATED DATE",render:function(e,t,r){return new Date(e).toLocaleDateString()}},{data:"charge",title:"CHARGE",render:function(e){return parseFloat(e).toFixed(2)}},{data:"gcash",title:"GCASH",render:function(e){return parseFloat(e).toFixed(2)}},{data:"paymaya",title:"PAYMAYA",render:function(e){return parseFloat(e).toFixed(2)}},{data:"card",title:"CARD",render:function(e){return parseFloat(e).toFixed(2)}},{data:"loyaltycard",title:"LOYALTY CARD",render:function(e){return parseFloat(e).toFixed(2)}},{data:"foodpanda",title:"FOODPANDA",render:function(e){return parseFloat(e).toFixed(2)}},{data:"grabfood",title:"GRABFOOD",render:function(e){return parseFloat(e).toFixed(2)}},{data:"representation",title:"REPRESENTATION",render:function(e){return parseFloat(e).toFixed(2)}}],h={paging:!0,pageLength:25,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,dom:"Bfrtip",buttons:["copy","csv","excel","pdf","print"]},A=()=>{if(o.value&&l.value&&new Date(o.value)>new Date(l.value)){alert("Start date cannot be later than end date"),o.value="",l.value="";return}B.get(route("reports.ar"),{startDate:o.value,endDate:l.value,stores:s.value},{preserveState:!0,preserveScroll:!0})};let p;C([s,o,l],()=>{clearTimeout(p),p=setTimeout(A,500)},{deep:!0}),S(()=>{clearTimeout(p)});const T=y(()=>v.value.reduce((e,t)=>(e.charge+=parseFloat(t.charge||0),e.gcash+=parseFloat(t.gcash||0),e.paymaya+=parseFloat(t.paymaya||0),e.card+=parseFloat(t.card||0),e.loyaltycard+=parseFloat(t.loyaltycard||0),e.foodpanda+=parseFloat(t.foodpanda||0),e.grabfood+=parseFloat(t.grabfood||0),e.representation+=parseFloat(t.representation||0),e),{charge:0,gcash:0,paymaya:0,card:0,loyaltycard:0,foodpanda:0,grabfood:0,representation:0}));return(e,t)=>(u(),_(L,{"active-tab":"ORDER"},{main:c(()=>[a("div",P,[d.userRole.toUpperCase()==="ADMIN"||d.userRole.toUpperCase()==="MANAGER"?(u(),f("div",Y,[g(U,{modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=r=>s.value=r),options:d.stores,label:"Stores"},null,8,["modelValue","options"])])):k("",!0),a("div",G,[t[4]||(t[4]=a("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),x(a("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=r=>o.value=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[D,o.value]])]),a("div",I,[t[5]||(t[5]=a("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),x(a("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=r=>l.value=r),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[D,l.value]])]),a("div",j,[a("button",{onClick:t[3]||(t[3]=()=>{s.value=[],o.value="",l.value=""}),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),a("details",H,[t[6]||(t[6]=a("summary",{class:"collapse-title text-sm font-medium"},"AR DETAILS",-1)),a("div",$,[a("div",X,[(u(!0),f(O,null,N(T.value,(r,n)=>(u(),f("div",{key:n,class:"bg-white p-4 rounded-lg shadow"},[a("h3",z,"Total "+b(n),1),a("p",J,"â‚± "+b(r.toFixed(2)),1)]))),128))])])]),g(q,null,{default:c(()=>[g(V(F),{data:v.value,columns:w,class:"w-full relative display",options:h},{action:c(r=>t[7]||(t[7]=[])),_:1},8,["data"])]),_:1})]),_:1}))}};export{ne as default};
