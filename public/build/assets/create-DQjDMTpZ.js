import{d as c,H as D,s as w,e as l,a as e,t as a,j as x,x as T,F as _,h as k,v as p,f as b,g as B,o as d}from"./app-Bt9aRD1P.js";const U={key:0,class:"fixed inset-0 z-50"},A={class:"fixed inset-0 z-10 overflow-y-auto"},L={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},O={class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-3xl"},z={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},E={class:"mt-5"},F={class:"mb-4"},Q={class:"mt-1 block w-full rounded-md border border-gray-300 bg-gray-50 px-3 py-2 text-gray-700 sm:text-sm"},P={class:"mb-4"},H=["value"],R={class:"mb-4"},G={class:"flex items-center justify-between mb-2"},J={class:"flex items-center"},K={class:"mt-2 border rounded-md max-h-60 overflow-y-auto"},W={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-4 py-2 text-sm"},Z={class:"px-4 py-2 text-sm"},$={class:"px-4 py-2 text-sm"},ee={class:"px-4 py-2"},te=["onUpdate:modelValue","onChange"],se={class:"mb-4"},oe={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md"},re={class:"text-sm text-red-600"},ne={class:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6"},ie=["disabled"],le={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},de={__name:"create",props:{showModal:Boolean,stores:{type:Array,required:!0},items:{type:Array,required:!0},currentStore:{type:String,required:!0},fromStoreName:{type:String,required:!0}},emits:["close"],setup(f,{emit:C}){const y=f,S=C,g=c(!1),u=c(""),m=c(""),v=c({}),i=c({}),I=(r,t)=>{r.target.value<0&&(i.value[t]=0)},o=D({to_store_id:"",notes:""}),V=w(()=>{if(!m.value)return y.items;const r=m.value.toLowerCase();return y.items.filter(t=>t.itemname.toLowerCase().includes(r)||t.itemid.toLowerCase().includes(r))}),j=w(()=>{const r=!!o.to_store_id,t=Object.values(v.value).some(n=>n),s=Object.entries(v.value).every(([n,N])=>!N||i.value[n]&&i.value[n]>0);return r&&t&&s}),h=()=>{S("close"),q()},q=()=>{o.to_store_id="",o.notes="",v.value={},i.value={},u.value="",m.value=""},M=async()=>{if(!y.currentStore){u.value="Current store not found. Please refresh the page.";return}if(!o.destinationStore){u.value="Please select a destination store";return}if(Object.entries(i.value).map(([t,s])=>({itemid:t,quantity:parseInt(s||0)})).filter(t=>t.quantity>0).length===0){u.value="Please add quantity for at least one item";return}};return(r,t)=>f.showModal?(d(),l("div",U,[t[12]||(t[12]=e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)),e("div",A,[e("div",L,[e("div",O,[e("div",z,[e("div",{class:"flex justify-between items-center"},[t[4]||(t[4]=e("h3",{class:"text-lg font-medium leading-6 text-gray-900"}," Create New Stock Transfer ",-1)),e("button",{onClick:h,class:"text-gray-400 hover:text-gray-500"},t[3]||(t[3]=[e("span",{class:"sr-only"},"Close",-1),e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",E,[e("div",F,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," From Store ",-1)),e("div",Q,a(f.fromStoreName),1)]),e("div",P,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," To Store (Destination) ",-1)),x(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.to_store_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:""},[t[6]||(t[6]=e("option",{value:""},"Select Destination Store",-1)),(d(!0),l(_,null,k(f.stores,s=>(d(),l("option",{key:s.STOREID,value:s.STOREID},a(s.NAME),9,H))),128))],512),[[T,o.to_store_id]])]),e("div",R,[e("div",G,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700"}," Select Items ",-1)),e("div",J,[x(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),placeholder:"Search items...",class:"rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[p,m.value]])])]),e("div",K,[e("table",W,[t[9]||(t[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500"},"Item ID"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500"},"Item Name"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500"},"Unit"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500"},"Quantity")])],-1)),e("tbody",X,[(d(!0),l(_,null,k(V.value,s=>(d(),l("tr",{key:s.itemid},[e("td",Y,a(s.itemid),1),e("td",Z,a(s.itemname),1),e("td",$,a(s.unitid),1),e("td",ee,[x(e("input",{type:"number","onUpdate:modelValue":n=>i.value[s.itemid]=n,min:"0",class:"w-20 rounded-md border-gray-300",onChange:n=>I(n,s.itemid)},null,40,te),[[p,i.value[s.itemid],void 0,{number:!0}]])])]))),128))])])])]),e("div",se,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Notes ",-1)),x(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.notes=s),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",placeholder:"Add any notes..."},null,512),[[p,o.notes]])]),u.value?(d(),l("div",oe,[e("p",re,a(u.value),1)])):b("",!0)])]),e("div",ne,[e("button",{type:"button",onClick:M,disabled:g.value||!j.value,class:"inline-flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},[g.value?(d(),l("svg",le,t[11]||(t[11]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),B(" "+a(g.value?"Creating...":"Create Transfer"),1)],8,ie),e("button",{type:"button",onClick:h,class:"mt-3 inline-flex w-full justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-base font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])])])])])):b("",!0)}};export{de as default};
