import{d as w,N as z,l as O,T as _,e as i,b as p,w as c,u as r,F as C,o as n,a as e,Z as P,i as N,j as m,v as T,t as l,f as y,s as k,h as $,n as B,y as Z,g as G}from"./app-BNPGhoL2.js";import{_ as H}from"./Main-CkYp62E2.js";import{_ as V}from"./Modal-BM4eYpSN.js";import{S as h}from"./sweetalert2.esm.all-IRYXxR_Z.js";import{d as J}from"./debounce-Bd81OnnV.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logout-B5n2G0rZ.js";/* empty css                                                             */import"./Modal-k3aPgSoE.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-B6Xc1nH0.js";import"./PartyCake143-DUp1Stp_.js";import"./Attendance-D3nGk9-s.js";const Q={class:"p-6"},R={class:"mb-4"},W={key:0,class:"mt-1 text-sm text-red-600"},X={class:"mb-4"},ee=["value"],te={key:0,class:"mt-1 text-sm text-red-600"},se={class:"mb-4"},oe={key:0,class:"mt-1 text-sm text-red-600"},re={class:"flex justify-end gap-2"},ae=["disabled"],le={class:"p-6"},ie={class:"mb-4"},ne={key:0,class:"mt-1 text-sm text-red-600"},de={class:"flex justify-end gap-2"},ue=["disabled"],ce={class:"container mx-auto px-4 mt-10 sm:px-6 lg:px-8"},pe={class:"mb-4 flex flex-col sm:flex-row justify-between items-center gap-4"},me={class:"flex gap-4 items-center w-full sm:w-auto"},ye={class:"flex-grow sm:flex-grow-0 sm:min-w-[300px]"},fe={class:"bg-white shadow rounded-lg overflow-hidden"},xe={class:"overflow-x-auto"},ge={class:"min-w-full divide-y divide-gray-200"},be={class:"bg-white divide-y divide-gray-200"},ve={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap"},he={class:"px-6 py-4 whitespace-nowrap"},_e={key:1},Ce={class:"px-6 py-4 whitespace-nowrap"},ke={class:"px-6 py-4 whitespace-nowrap"},Se={class:"px-6 py-4 whitespace-nowrap"},Le={class:"flex gap-2"},Ee=["onClick"],Ne=["onClick"],Te={key:0},$e={colspan:"6",class:"px-6 py-4 text-center text-gray-500"},Be={__name:"Index",props:{loyaltyCards:{type:Array,required:!0},customers:{type:Array,required:!0},filters:{type:Object,default:()=>({search:""})}},setup(f){const x=w(f.filters.search),M=J(o=>{z.get("/loyalty-cards",{search:o},{preserveState:!0,preserveScroll:!0,replace:!0})},300);O(x,o=>{M(o)});const u=h.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:o=>{o.addEventListener("mouseenter",h.stopTimer),o.addEventListener("mouseleave",h.resumeTimer)}}),g=w(!1),b=w(!1),v=w(null),a=_({customer_id:"",status:"active",card_number:""}),d=_({status:""}),A=o=>o?`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800"}[o]||"bg-gray-100 text-gray-800"}`:"",D=o=>o?`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${{bronze:"bg-yellow-100 text-yellow-800",silver:"bg-gray-100 text-gray-800",gold:"bg-yellow-300 text-yellow-900",platinum:"bg-purple-100 text-purple-800"}[o]||"bg-gray-100 text-gray-800"}`:"",S=o=>o?o.charAt(0).toUpperCase()+o.slice(1):"",U=o=>o?new Date(o).toLocaleDateString():"",F=()=>{a.post("/loyalty-cards",{preserveScroll:!0,onSuccess:()=>{u.fire({icon:"success",title:"Loyalty card created successfully"}),g.value=!1,a.reset()},onError:()=>{u.fire({icon:"error",title:"Failed to create loyalty card"})}})},q=o=>{v.value=o,d.status=o.status,b.value=!0},j=()=>{d.put(`/loyalty-cards/${v.value.id}`,{preserveScroll:!0,onSuccess:()=>{u.fire({icon:"success",title:"Loyalty card updated successfully"}),b.value=!1,d.reset(),v.value=null},onError:()=>{u.fire({icon:"error",title:"Failed to update loyalty card"})}})},I=async o=>{(await h.fire({title:"Are you sure?",text:"You will not be able to recover this loyalty card!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed&&_().delete(`/loyalty-cards/${o.id}`,{preserveScroll:!0,onSuccess:()=>{u.fire({icon:"success",title:"Loyalty card deleted successfully"})},onError:s=>{u.fire({icon:"error",title:s.points||"Failed to delete loyalty card"})}})},L=()=>{g.value=!1,a.reset(),a.clearErrors()},E=()=>{b.value=!1,d.reset(),d.clearErrors(),v.value=null};return(o,t)=>(n(),i(C,null,[p(r(P),{title:"Loyalty Cards"},{default:c(()=>t[6]||(t[6]=[e("meta",{name:"description",content:"Loyalty Cards Management System"},null,-1)])),_:1}),p(H,{"active-tab":"LOYALTY",user:o.$page.props.auth.user},{modals:c(()=>[p(V,{show:g.value,onClose:L},{default:c(()=>[e("div",Q,[t[12]||(t[12]=e("h2",{class:"text-xl font-bold mb-4"},"Create New Loyalty Card",-1)),e("form",{onSubmit:N(F,["prevent"])},[e("div",R,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700"},"Card Number",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r(a).card_number=s),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},null,512),[[T,r(a).card_number]]),r(a).errors.card_number?(n(),i("p",W,l(r(a).errors.card_number),1)):y("",!0)]),e("div",X,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700"},"Customer",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r(a).customer_id=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},[t[8]||(t[8]=e("option",{value:""},"Select a customer",-1)),(n(!0),i(C,null,$(f.customers,s=>(n(),i("option",{key:s.id,value:s.id},l(s.name)+" ("+l(s.account)+") ",9,ee))),128))],512),[[k,r(a).customer_id]]),r(a).errors.customer_id?(n(),i("p",te,l(r(a).errors.customer_id),1)):y("",!0)]),e("div",se,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r(a).status=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},t[10]||(t[10]=[e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1),e("option",{value:"suspended"},"Suspended",-1)]),512),[[k,r(a).status]]),r(a).errors.status?(n(),i("p",oe,l(r(a).errors.status),1)):y("",!0)]),e("div",re,[e("button",{type:"button",onClick:L,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancel "),e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",disabled:r(a).processing},l(r(a).processing?"Creating...":"Create"),9,ae)])],32)])]),_:1},8,["show"]),p(V,{show:b.value,onClose:E},{default:c(()=>[e("div",le,[t[15]||(t[15]=e("h2",{class:"text-xl font-bold mb-4"},"Edit Loyalty Card",-1)),e("form",{onSubmit:N(j,["prevent"])},[e("div",ie,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700"},"Status",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>r(d).status=s),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",required:""},t[13]||(t[13]=[e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1),e("option",{value:"suspended"},"Suspended",-1)]),512),[[k,r(d).status]]),r(d).errors.status?(n(),i("p",ne,l(r(d).errors.status),1)):y("",!0)]),e("div",de,[e("button",{type:"button",onClick:E,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," Cancel "),e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",disabled:r(d).processing},l(r(d).processing?"Updating...":"Update"),9,ue)])],32)])]),_:1},8,["show"])]),main:c(()=>[e("div",ce,[e("div",pe,[t[16]||(t[16]=e("h1",{class:"text-2xl font-bold"},"Loyalty Cards Management",-1)),e("div",me,[e("div",ye,[m(e("input",{type:"text",placeholder:"Search cards, accounts.....","onUpdate:modelValue":t[4]||(t[4]=s=>x.value=s),class:"w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[T,x.value]])]),e("button",{onClick:t[5]||(t[5]=s=>g.value=!0),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 whitespace-nowrap"}," Create New Card ")])]),e("div",fe,[e("div",xe,[e("table",ge,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Card Number"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Points"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tier"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Expiry Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",be,[(n(!0),i(C,null,$(f.loyaltyCards,s=>(n(),i("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ve,l(s.card_number),1),e("td",we,l(s.points_formatted),1),e("td",he,[s.tier?(n(),i("span",{key:0,class:B(D(s.tier))},l(S(s.tier)),3)):(n(),i("span",_e,"-"))]),e("td",Ce,[e("span",{class:B(A(s.status))},l(S(s.status)),3)]),e("td",ke,l(U(s.expiry_date)),1),e("td",Se,[e("div",Le,[p(r(Z),{href:`/loyalty-cards/${s.customer_id}`,class:"text-indigo-600 hover:text-indigo-900"},{default:c(()=>t[17]||(t[17]=[G(" View ")])),_:2},1032,["href"]),e("button",{onClick:Y=>q(s),class:"text-green-600 hover:text-green-900"}," Edit ",8,Ee),e("button",{onClick:Y=>I(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,Ne)])])]))),128)),f.loyaltyCards.length===0?(n(),i("tr",Te,[e("td",$e,l(x.value?"No loyalty cards found matching your search":"No loyalty cards found"),1)])):y("",!0)])])])])])]),_:1},8,["user"])],64))}},Ze=K(Be,[["__scopeId","data-v-0fd170bc"]]);export{Ze as default};
