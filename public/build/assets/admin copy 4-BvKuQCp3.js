import{C as _,d,q as F,l as Z,k as J,c as M,w as L,o as c,a as e,j as x,v as h,n as m,e as y,t as p,f as K,b as $,h as j,D as X,B as Y,F as I,a0 as tt}from"./app-BoaMMdkU.js";import{C as D,r as et}from"./chart-8SaNzrGi.js";import{_ as ot}from"./AdminPanel-CRYPwC5J.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{D as U,I as st,r as rt,R as lt,P as nt}from"./CubeIcon-HJR3n7Ua.js";import{_ as it}from"./MultiSelectDropdown-CvWO6dSB.js";import"./RetailGroup-BjeigQ0x.js";import"./Logout-BJuIbz2k.js";/* empty css                                                             */import"./Modal-5-iMnX7J.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-DFF7VX6Y.js";import"./RetailItems-BB1M731N.js";import"./Attendance-CU9DKH9f.js";const dt={class:"min-h-screen bg-gray-50 p-6"},ct={class:"mb-6 bg-white rounded-xl shadow-md p-4"},ut={class:"flex items-center space-x-4"},mt={class:"flex flex-col"},pt={class:"flex items-center space-x-2"},bt={key:0,class:"text-red-500 text-sm mt-1"},vt={class:"flex items-center space-x-2"},yt={class:"text-3xl font-bold text-gray-800"},gt={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8"},ft=["onMouseenter"],_t={class:"p-6"},xt={class:"flex items-center justify-between"},ht={class:"mt-4"},Ct={class:"text-sm font-medium text-gray-600"},wt={class:"text-sm text-gray-500 mt-2"},At={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},St={class:"bg-white rounded-xl shadow-md p-6"},Pt={class:"h-[400px]"},Tt={class:"bg-white rounded-xl shadow-md p-6"},kt={class:"space-y-4 max-h-[400px] overflow-y-auto"},Dt={class:"font-semibold text-gray-800"},Vt={class:"text-gray-600 mt-2"},Bt={key:1,class:"text-gray-500 text-center py-4"},Nt={class:"bg-white rounded-xl shadow-md p-6"},Et={class:"flex justify-between items-center mb-4"},Ot={class:"flex space-x-4"},Rt={class:"h-[500px]"},Ft={__name:"admin copy 4",props:{username:{type:String,default:"User"},announcements:{type:Array,required:!0},metrics:{type:Object,required:!0,default:()=>({totalGross:0,totalNetsales:0,totalDiscount:0,totalCost:0,totalVat:0,totalVatableSales:0,paymentBreakdown:{cash:0,gcash:0,paymaya:0,card:0,loyaltyCard:0,foodPanda:0,grabFood:0}})}},setup(f){D.register(...et),_.defaults.headers.common["X-CSRF-TOKEN"]=document.querySelector('meta[name="csrf-token"]').getAttribute("content");const V=f,C=d(V.initialMetrics),b=d("");d(null),d(null);const B=d([]),u=d([]),q=async()=>{try{const a=await _.get(route("get.stores"));B.value=a.data,u.value=a.data}catch(a){console.error("Error fetching stores:",a)}},w=d(null),Q=d(!1),A=d(null),S=d(null);let P=null,T=null;const r=d({start_date:"2024-11-25",end_date:new Date().toISOString().split("T")[0]}),z=F(()=>{const a=new Date(r.value.start_date),t=new Date(r.value.end_date),o=new Date;return a<=t&&a<=o&&t<=o}),v=a=>{const t=Number(a);return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(isNaN(t)?0:t)},G=F(()=>{const a=C.value||{};return[{title:"TOTAL GROSS",value:v(a.totalGross),icon:U,color:"text-blue-600",bgColor:"bg-blue-100",description:"Total revenue before deductions"},{title:"TOTAL NETSALES",value:v(a.totalNetsales),icon:st,color:"text-green-600",bgColor:"bg-green-100",description:"Revenue after all deductions"},{title:"TOTAL DISCOUNT",value:v(a.totalDiscount),icon:U,color:"text-amber-600",bgColor:"bg-amber-100",description:"Sum of all applied discounts"},{title:"TOTAL COST",value:v(a.totalCost),icon:rt,color:"text-purple-600",bgColor:"bg-purple-100",description:"Aggregate cost of goods sold"},{title:"TOTAL VAT",value:v(a.totalVat),icon:lt,color:"text-pink-600",bgColor:"bg-pink-100",description:"Value Added Tax collected"},{title:"VATABLE SALES",value:v(a.totalVatableSales),icon:nt,color:"text-indigo-600",bgColor:"bg-indigo-100",description:"Sales subject to VAT"}]}),H=()=>{var l;if(!A.value)return;const a=A.value.getContext("2d");P&&P.destroy();const t=((l=C.value)==null?void 0:l.paymentBreakdown)||{},o=Object.keys(t).map(i=>i.replace(/([A-Z])/g," $1").trim()),n=Object.values(t).map(i=>Number(i)||0);P=new D(a,{type:"pie",data:{labels:o,datasets:[{data:n,backgroundColor:["#3B82F6","#10B981","#F43F5E","#6366F1","#8B5CF6","#EC4899","#F97316"],hoverOffset:4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right"},tooltip:{callbacks:{label:function(i){const g=i.dataset.data.reduce((R,W)=>R+W,0),s=i.parsed,k=(s/g*100).toFixed(2);return`${i.label}: ${s.toFixed(2)} (${k}%)`}}}}}})},N=async()=>{var a,t;try{const n={start_date:r.value.start_date||"2000-01-01",end_date:r.value.end_date,stores:u.value.map(s=>s.NAME||(typeof s=="object"?s.NAME:s))},l=await _.post(route("get.top.bottom.products"),n),i=Array.isArray((a=l==null?void 0:l.data)==null?void 0:a.topProducts)?l.data.topProducts:[],g=Array.isArray((t=l==null?void 0:l.data)==null?void 0:t.bottomProducts)?l.data.bottomProducts:[];E(i,g)}catch(o){console.error("Error fetching top/bottom products:",o),E([],[])}},E=(a,t)=>{if(!S.value)return;const o=S.value.getContext("2d");T&&T.destroy();const n=a.slice(0,10).map(s=>s.itemname),l=t.slice(0,10).map(s=>s.itemname),i=a.slice(0,10).map(s=>s.total_quantity),g=t.slice(0,10).map(s=>s.total_quantity);T=new D(o,{type:"bar",data:{labels:[...n,...l],datasets:[{label:"Top 10 Products (Quantity)",data:i,backgroundColor:"rgba(75, 192, 192, 0.6)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1},{label:"Bottom 10 Products (Quantity)",data:[...Array(10).fill(0),...g],backgroundColor:"rgba(255, 99, 132, 0.6)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:function(s){const k=s.parsed.y;return`${s.dataset.label}: ${k.toFixed(2)}`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Quantity Sold"}}}}})},O=async()=>{try{console.log("Selected Stores:",u.value);const a={start_date:r.value.start_date||"2000-01-01",end_date:r.value.end_date,stores:u.value.map(o=>typeof o=="object"?o.NAME:o)};console.log("Payload for metrics:",a);const t=await _.post(route("get.metrics"),a);console.log("Metrics response:",t.data),C.value=t.data||V.initialMetrics,H()}catch(a){console.error("Error fetching metrics:",a)}};return Z([()=>r.value.start_date,()=>r.value.end_date,()=>JSON.stringify(u.value)],()=>{z.value?(b.value="",O(),N()):b.value="Invalid date range. Please check your selections."}),J(()=>{q(),O(),N()}),(a,t)=>(c(),M(ot,{"active-tab":"DASHBOARD"},{main:L(()=>[e("div",dt,[e("div",ct,[e("div",ut,[e("div",mt,[e("div",pt,[t[6]||(t[6]=e("label",{class:"text-gray-700"},"Start Date:",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=o=>r.value.start_date=o),class:m(["border rounded px-2 py-1",{"border-red-500":b.value}])},null,2),[[h,r.value.start_date]]),t[7]||(t[7]=e("label",{class:"text-gray-700"},"End Date:",-1)),x(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=o=>r.value.end_date=o),class:m(["border rounded px-2 py-1",{"border-red-500":b.value}])},null,2),[[h,r.value.end_date]])]),b.value?(c(),y("p",bt,p(b.value),1)):K("",!0)]),e("div",vt,[t[8]||(t[8]=e("label",{class:"text-gray-700"},"Stores:",-1)),$(it,{modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value=o),options:B.value,multiple:!0},null,8,["modelValue","options"])])])]),e("div",{class:m(["mb-8 transform transition-all duration-500",[Q.value?"translate-y-0 opacity-100":"translate-y-4 opacity-0"]])},[e("h1",yt," Welcome back, "+p(f.username)+"! ðŸ‘‹ ",1),t[9]||(t[9]=e("p",{class:"text-gray-600 mt-2"}," Here's your business overview for today ",-1))],2),e("div",gt,[$(tt,{"enter-active-class":"transition-all duration-500 ease-out","enter-from-class":"opacity-0 transform translate-y-4","enter-to-class":"opacity-100 transform translate-y-0","move-class":"transition-all duration-300"},{default:L(()=>[(c(!0),y(I,null,j(G.value,(o,n)=>(c(),y("div",{key:o.title,class:"metric-card",style:X({transitionDelay:`${n*100}ms`}),onMouseenter:l=>w.value=n,onMouseleave:t[3]||(t[3]=l=>w.value=null)},[e("div",{class:m(["bg-white rounded-xl shadow-md transition-all duration-300 transform hover:scale-105",{"shadow-lg":w.value===n}])},[e("div",_t,[e("div",xt,[e("div",{class:m([o.bgColor,"p-3 rounded-lg"])},[(c(),M(Y(o.icon),{class:m([o.color,"w-6 h-6"])},null,8,["class"]))],2)]),e("div",ht,[e("p",Ct,p(o.title),1),e("p",{class:m([o.color,"text-2xl font-bold mt-2"])},p(o.value),3),e("p",wt,p(o.description),1)])])],2)],44,ft))),128))]),_:1})]),e("div",At,[e("div",St,[t[10]||(t[10]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"}," Payment Methods Distribution ",-1)),e("div",Pt,[e("canvas",{ref_key:"chartRef",ref:A},null,512)])]),e("div",Tt,[t[11]||(t[11]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4"}," Recent Announcements ",-1)),e("div",kt,[f.announcements.length?(c(!0),y(I,{key:0},j(f.announcements,(o,n)=>(c(),y("div",{key:n,class:"p-4 border border-gray-100 rounded-lg hover:border-blue-500 transition-all duration-300"},[e("h4",Dt,p(o.title),1),e("p",Vt,p(o.description),1)]))),128)):(c(),y("p",Bt," No announcements available "))])])]),e("div",Nt,[e("div",Et,[t[12]||(t[12]=e("h3",{class:"text-lg font-semibold text-gray-800"}," Top & Bottom Products Analysis ",-1)),e("div",Ot,[x(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=o=>r.value.start_date=o),class:"border rounded px-2 py-1"},null,512),[[h,r.value.start_date]]),x(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=o=>r.value.end_date=o),class:"border rounded px-2 py-1"},null,512),[[h,r.value.end_date]])])]),e("div",Rt,[e("canvas",{ref_key:"topBottomProductsRef",ref:S},null,512)])])])]),_:1}))}},Jt=at(Ft,[["__scopeId","data-v-50e91ae8"]]);export{Jt as default};
