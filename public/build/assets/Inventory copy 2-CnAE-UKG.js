import{o as b,e as x,m as Y,T as j,s as g,d as A,p as F,c as G,w as T,b as p,a as o,i as H,j as S,v as _,u as m,n as V,h as B,t as U,F as q}from"./app-BNibTCyr.js";import{_ as W}from"./AdminPanel-mtITC6Fj.js";import{T as P}from"./TableContainer-CuVhNmKS.js";import{P as C,D as J}from"./dataTables-Re_5fNvq.js";import{_ as Q}from"./SuccessButton-B-Amirux.js";import{_ as X}from"./TransparentButton-CbA-oEmG.js";import{_ as Z}from"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-BwnXT4mO.js";import{E as K}from"./Excel-BugV5v_P.js";import{_ as tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{S as et}from"./SearchColored-CB6DMBSA.js";import{E as rt}from"./exceljs.min-cUCnwqRh.js";import"./RetailGroup-aZWFSXoe.js";import"./Logout-CW2hOaSD.js";/* empty css                                                             */import"./Modal-BIe7acJJ.js";import"./RetailItems-B7IK_33H.js";import"./Attendance-CU-uXiMC.js";const at={},ot={viewBox:"0 0 1024 1024",class:"icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"#000000"};function st(l,s){return b(),x("svg",ot,s[0]||(s[0]=[Y('<g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M192 234.666667h640v64H192z" fill="#424242"></path><path d="M85.333333 533.333333h853.333334v-149.333333c0-46.933333-38.4-85.333333-85.333334-85.333333H170.666667c-46.933333 0-85.333333 38.4-85.333334 85.333333v149.333333z" fill="#616161"></path><path d="M170.666667 768h682.666666c46.933333 0 85.333333-38.4 85.333334-85.333333v-170.666667H85.333333v170.666667c0 46.933333 38.4 85.333333 85.333334 85.333333z" fill="#424242"></path><path d="M853.333333 384m-21.333333 0a21.333333 21.333333 0 1 0 42.666667 0 21.333333 21.333333 0 1 0-42.666667 0Z" fill="#00E676"></path><path d="M234.666667 85.333333h554.666666v213.333334H234.666667z" fill="#90CAF9"></path><path d="M800 661.333333h-576c-17.066667 0-32-14.933333-32-32s14.933333-32 32-32h576c17.066667 0 32 14.933333 32 32s-14.933333 32-32 32z" fill="#242424"></path><path d="M234.666667 661.333333h554.666666v234.666667H234.666667z" fill="#90CAF9"></path><path d="M234.666667 618.666667h554.666666v42.666666H234.666667z" fill="#42A5F5"></path><path d="M341.333333 704h362.666667v42.666667H341.333333zM341.333333 789.333333h277.333334v42.666667H341.333333z" fill="#1976D2"></path></g>',3)]))}const nt=tt(at,[["render",st]]),lt={class:"absolute adjust"},dt={class:"flex justify-start items-center"},it=["value"],ct={"date-rangepicker":"",class:"flex items-center"},ut={class:"relative ml-5"},pt=["placeholder"],ht={class:"relative"},mt=["placeholder"],ft={props:{orders:{type:Array,required:!0,default:()=>[]}},computed:{flattenedOrders(){return this.calculateFlattenedOrders(this.orders)},grandTotal(){return this.flattenedOrders.reduce((l,s)=>l+(s.TOTAL||0),0)},uniqueDates(){const l=new Set;return this.flattenedOrders.forEach(s=>{s.dates&&Object.keys(s.dates).forEach(f=>l.add(f))}),Array.from(l).sort()}},methods:{calculateFlattenedOrders(l){return l.map(s=>({ITEMID:s.ITEMID,ITEMNAME:s.ITEMNAME,CATEGORY:s.CATEGORY,TOTAL:s.TOTAL,dates:s.dates||{}}))},async exportToExcel(){console.log("Starting exportToExcel"),console.log("flattenedOrders:",this.flattenedOrders);try{if(!this.flattenedOrders||!Array.isArray(this.flattenedOrders)||this.flattenedOrders.length===0){console.error("No data to export");return}const l=new rt.Workbook,s=l.addWorksheet("Orders"),f=[{header:"ITEMID",key:"ITEMID",width:15},{header:"ITEMNAME",key:"ITEMNAME",width:30},{header:"CATEGORY",key:"CATEGORY",width:20},{header:"TOTAL",key:"TOTAL",width:15}];this.uniqueDates.forEach(c=>{f.push({header:c,key:c,width:15})}),s.columns=f,this.flattenedOrders.forEach(c=>{const y={ITEMID:c.ITEMID,ITEMNAME:c.ITEMNAME,CATEGORY:c.CATEGORY,TOTAL:c.TOTAL};this.uniqueDates.forEach(E=>{y[E]=c.dates[E]||0}),s.addRow(y)}),s.getRow(1).font={bold:!0},s.getRow(1).alignment={vertical:"middle",horizontal:"center"};const n=new Date,v=`Orders_${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}-${String(n.getDate()).padStart(2,"0")}.xlsx`,w=await l.xlsx.writeBuffer();this.saveExcelFile(w,v)}catch(l){console.error("Error exporting to Excel:",l)}},saveExcelFile(l,s){const f=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),n=document.createElement("a");n.href=URL.createObjectURL(f),n.download=s,n.click(),URL.revokeObjectURL(n.href)}}},Rt=Object.assign(ft,{__name:"Inventory copy 2",props:{orders:{type:Array,required:!0}},setup(l,{emit:s}){C.use(J);const f=l,n=j({StartDate:"",EndDate:""}),v=()=>{n.get(route("orderingconso.getrange"),{preserveScroll:!0})},w={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,error:function(e,t,r){console.error("DataTables error:",t)}},c=g(()=>f.orders.reduce((e,t)=>{const{ITEMID:r,ITEMNAME:a,CATEGORY:d,COUNTED:i,createddatetime:u}=t,h=new Date(u).toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"}),k=parseInt(i,10)||0;return e[r]||(e[r]={ITEMID:r,ITEMNAME:a,CATEGORY:d,TOTAL:0,dates:Object.fromEntries(E.value.map(z=>[z,0]))}),e[r].dates[h]=(e[r].dates[h]||0)+k,e[r].TOTAL+=k,e},{})),y=g(()=>{const e=Object.values(c.value),t={ITEMID:"TOTAL",ITEMNAME:"",CATEGORY:"",TOTAL:e.reduce((r,a)=>r+a.TOTAL,0),dates:Object.fromEntries(E.value.map(r=>[r,e.reduce((a,d)=>a+(d.dates[r]||0),0)]))};return e.push(t),e}),E=g(()=>{const e=new Date,t=e.getFullYear(),r=e.getMonth(),a=new Date(t,r+1,0).getDate(),d=[];for(let i=1;i<=a;i++){const u=new Date(t,r,i);d.push(u.toLocaleDateString("en-US",{month:"numeric",day:"numeric",year:"numeric"}))}return d}),R=g(()=>[{title:"ITEMID",data:"ITEMID"},{title:"ITEMNAME",data:"ITEMNAME"},{title:"CATEGORY",data:"CATEGORY"},{title:"TOTAL",data:"TOTAL"},...E.value.map(e=>({title:e,data:null,render:(t,r,a)=>a.dates[e]||0}))]),O=A(null),M=g(()=>{if(O.value){const e=new Date(O.value),t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}return""}),I=A(null),D=g(()=>{if(I.value){const e=new Date(I.value),t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}return""});g(()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}${r}${a}`});const L=()=>{const e=new Date().toLocaleDateString(),t=new Date().toLocaleTimeString();let r=`
    <html>
      <head>
        <title>Order Receipt</title>
        <style>
          body {
            font-family: 'Courier New', monospace;
            font-size: 8pt;
            width: 8mm;
            margin: 0;
            padding: 0;
          }
          .center { text-align: center; }
          .bold { font-weight: bold; }
          .underline { border-bottom: 1px solid black; }
        </style>
      </head>
      <body>
        <div class="center bold" style="width: 200px">ORDER RECEIPT</div>
        <div class="center" style="width: 200px">${e} ${t}</div>
  `;const a=y.value.reduce((d,i)=>(Object.entries(i).forEach(([u,h])=>{typeof h=="object"&&h!==null&&"count"in h&&"STOREID"in h&&h.count>0&&(d[u]||(d[u]=[]),d[u].push({ITEMID:i.ITEMID,ITEMNAME:i.ITEMNAME,count:h.count}))}),d),{});return Object.entries(a).forEach(([d,i])=>{r+=`
      <div class="bold" style="width:200px; ">${d} Branch:</div>
      <table style="width:90%">
        <tr>
          <th>Item</th>
          <th>Qty</th>
        </tr>
    `,i.forEach(u=>{r+=`
        <tr>
          <td style="font-size: 12px">${u.ITEMNAME.substring(0,12)}...</td>
          <td style="font-size: 12px">${u.count}</td>
        </tr>
      `}),r+=`
      </table>
    `}),r+=`
        <div class="bold" style="width: 200px">Total: ${$.value}</div>
        <div class="center" style="width: 200px">Thank you for your order!</div>
      </body>
    </html>
  `,r},$=g(()=>y.value.reduce((e,t)=>e+Object.values(t).reduce((r,a)=>typeof a=="object"&&a!==null&&"count"in a?r+a.count:r,0),0)),N=()=>{const e=L(),t=window.open("","_blank");t.document.write(e),t.document.close(),t.print()};return(e,t)=>{const r=F("InputError");return b(),G(W,{"active-tab":"FG"},{main:T(()=>[p(P,null,{default:T(()=>[o("div",lt,[o("div",dt,[o("form",{onSubmit:H(v,["prevent"]),class:"px-2 py-3 max-h-[50vh] lg:max-h-[70vh] overflow-y-auto"},[o("input",{type:"hidden",name:"_token",value:e.$page.props.csrf_token},null,8,it),o("div",ct,[o("div",ut,[t[4]||(t[4]=o("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[o("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[o("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),S(o("input",{id:"StartDate",type:"date","onUpdate:modelValue":t[0]||(t[0]=a=>m(n).StartDate=a),onInput:t[1]||(t[1]=(...a)=>M.value&&M.value(...a)),placeholder:M.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,pt),[[_,m(n).StartDate]]),p(r,{message:m(n).errors.StartDate,class:"mt-2"},null,8,["message"])]),t[6]||(t[6]=o("span",{class:"mx-4 text-gray-500"},"to",-1)),o("div",ht,[t[5]||(t[5]=o("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[o("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[o("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),S(o("input",{id:"EndDate",type:"date","onUpdate:modelValue":t[2]||(t[2]=a=>m(n).EndDate=a),onInput:t[3]||(t[3]=(...a)=>D.value&&D.value(...a)),placeholder:D.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,mt),[[_,m(n).EndDate]]),p(r,{message:m(n).errors.EndDate,class:"mt-2"},null,8,["message"])])])],32),p(X,{type:"submit",onClick:v,disabled:m(n).processing,class:V({"opacity-25":m(n).processing})},{default:T(()=>[p(et,{class:"h-8"})]),_:1},8,["disabled","class"]),t[7]||(t[7]=o("details",{className:"dropdown"},[o("summary",{className:"btn m-1"},"RECENT"),o("ul",{className:"menu dropdown-content bg-base-100 rounded-box z-[1] w-52 p-2 shadow"},[o("li",null,[o("a",{href:"/lastmonth"},"Last Month")]),o("li",null,[o("a",{href:"/lastweek"},"Last Week")]),o("li",null,[o("a",{href:"/yesterday"},"Yesterday")])])],-1)),p(Q,{type:"button",onClick:e.exportToExcel,class:"m-6 bg-green"},{default:T(()=>[p(K,{class:"h-4"})]),_:1},8,["onClick"]),p(Z,{type:"button",onClick:N,class:"bg-navy"},{default:T(()=>[p(nt,{class:"h-5"})]),_:1})])]),p(m(C),{data:y.value,columns:R.value,options:w,class:"display"},{default:T(()=>[o("thead",null,[o("tr",null,[t[8]||(t[8]=o("th",null,"ITEMID",-1)),t[9]||(t[9]=o("th",null,"ITEMNAME",-1)),t[10]||(t[10]=o("th",null,"CATEGORY",-1)),t[11]||(t[11]=o("th",null,"TOTAL",-1)),(b(!0),x(q,null,B(E.value,a=>(b(),x("th",{key:a},U(a),1))),128))])])]),_:1},8,["data","columns"])]),_:1})]),_:1})}}});export{Rt as default};
