import{R as $}from"./RetailItems-DeQMtUxX.js";import{P as I}from"./PartyCake143-wXgZtU6V.js";import{d as r,s as j,p as k,e as M,a as e,t as R,b as o,w as n,o as A,u as w,g as h}from"./app-NPxLYQzb.js";/* empty css                                                             */import{C as P}from"./Cart-Bs00Atza.js";import{u as N}from"./vue-router-B1pkOmgw.js";/* empty css                                                                   */import{_ as p}from"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-COOUSa13.js";import{_ as F}from"./SuccessButton-BNUgJNAf.js";import"./FileSaver.min-BnsFubRA.js";import"./exceljs.min-DeYFmjAR.js";import{A as Y}from"./Add-Bfvx7ttD.js";import{T as y}from"./TableContainer-fwPJTGzy.js";import{P as x,D as B}from"./dataTables-B8uMeSpA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"flex flex-col min-h-screen"},q={class:"sticky top-0 bg-navy shadow-md z-10 mb-5"},L={class:"container mx-auto px-4 py-3 flex justify-between items-center"},U={class:"text-sm font-bold text-white"},z={class:"flex-grow px-4 pb-20"},X={class:""},G={class:"flex justify-start items-center"},H={class:"flex flex-col sm:flex-row justify-start"},J={class:"mb-4"},K={class:"flex flex-wrap justify-start items-center"},Q={class:"fixed bottom-0 left-0 right-0 bg-navy shadow-lg"},W={class:"flex justify-around items-center h-16 relative"},Z={href:"/m-retail",class:"flex flex-col items-center text-white"},tt={href:"/m-partycakes",class:"flex flex-col items-center text-white"},et={href:"/m-orders",class:"flex flex-col items-center text-white"},ht={__name:"m-order",props:{inventjournaltables:{type:Array,required:!0},orders:{type:Array,required:!0}},setup(d){x.use(B);const D=r("");r(""),r(""),r(""),r(!1);const v=r(!1);r(!1),r(!1);const b=r(!1),f=d,E=[{data:"STOREID",title:"STOREID"},{data:"POSTEDDATETIME",title:"POSTEDDATETIME",render:function(s,t,l){return new Date(s).toLocaleDateString()}},{data:"ITEMID",title:"ITEMID"},{data:"COUNTED",title:"COUNTED"}],T=[{data:"posted",title:"POSTED"},{data:"createddatetime",title:"DATE",render:function(s,t,l){const a=new Date(s),i=a.getFullYear(),m=String(a.getMonth()+1).padStart(2,"0"),u=String(a.getDate()).padStart(2,"0");return`${i}-${m}-${u}`}},{data:null,render:"#action",title:"ACTIONS"}],g={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0},S=s=>{D.value=s,b.value=!0},_=()=>{v.value=!0};N();const C=s=>{console.log("Redirecting to Item Order Entries for account:",s),window.location.href=`/m-ItemOrders/${s}`};j(()=>{const s=new Date,t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0");return`${t}${l}${a}`});async function O(){const s=f.orders[0].STOREID,t=new Date(f.orders[0].POSTEDDATETIME),l=`${t.getFullYear()}${(t.getMonth()+1).toString().padStart(2,"0")}${t.getDate().toString().padStart(2,"0")}`,a=`${s}${l}.txt`,i=`${s}|${t.toLocaleDateString()}`,m=f.orders.map(c=>`${c.ITEMID}|${Math.floor(c.COUNTED)}`),u=[i,...m].join(`
`);try{(await(await fetch("/save-file",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({content:u,filename:a})})).json()).success?alert("Your order has been successfully sent to the head office!"):alert("Error saving file")}catch(c){console.error("Error:",c),alert("Error saving file")}}return(s,t)=>{const l=k("ExcelIcon");return A(),M("div",V,[e("header",q,[e("div",L,[t[0]||(t[0]=e("h1",{class:"text-sm font-bold text-white"},"ECORDER",-1)),e("h1",U,R(s.$page.props.auth.user.name),1)])]),e("main",z,[e("div",X,[e("div",G,[o(p,{type:"button",onClick:_,class:"bg-red-900 ml-2"},{default:n(()=>[o(Y,{class:"h-4"})]),_:1})])]),o(y,{class:"overflow-x-auto"},{default:n(()=>[o(w(x),{data:d.inventjournaltables,columns:T,class:"w-full relative display",options:g},{action:n(a=>[e("div",H,[o(p,{class:"cursor-pointer bg-navy mb-2 sm:mb-0 sm:mr-2 text-center flex items-center justify-center",onClick:i=>C(a.cellData.journalid)},{default:n(()=>t[1]||(t[1]=[h(" ORDER ")])),_:2},1032,["onClick"]),o(p,{class:"cursor-pointer bg-red-900 flex items-center justify-center",onClick:i=>S(a.cellData.journalid)},{default:n(()=>t[2]||(t[2]=[h(" POST ")])),_:2},1032,["onClick"])])]),_:1},8,["data"])]),_:1}),o(y,{class:"hidden overflow-x-auto mt-8"},{default:n(()=>[e("div",J,[e("div",K,[e("button",{onClick:O,class:"mb-2 mr-2"},"Generate and Download Text File"),o(F,{type:"button",onClick:s.exportToExcel,class:"bg-green"},{default:n(()=>[o(l,{class:"h-4"})]),_:1},8,["onClick"])])]),o(w(x),{data:d.orders,columns:E,class:"w-full relative display",options:g},{action:n(a=>t[3]||(t[3]=[e("div",{class:"flex justify-start"},null,-1)])),_:1},8,["data"])]),_:1})]),e("nav",Q,[e("div",W,[t[7]||(t[7]=e("a",{href:"/dashboard",class:"flex flex-col items-center text-blue-400"},[e("svg",{class:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})]),e("span",{class:"text-xs mt-1"},"Home")],-1)),e("a",Z,[o($,{class:"w-5 sm:w-6"}),t[4]||(t[4]=e("span",{class:"text-xs mt-1"},"Retail",-1))]),t[8]||(t[8]=e("button",{onclick:"window.location.href='/m-order'",class:"absolute left-1/2 top-0 transform -translate-x-1/2 -translate-y-1/2 w-14 h-14 bg-blue-700 rounded-full shadow-lg flex items-center justify-center border-2 border-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[e("span",{class:"text-xs mt-1 font-bold text-white"},"EC")],-1)),e("a",tt,[o(I,{class:"w-5 sm:w-6"}),t[5]||(t[5]=e("span",{class:"text-xs mt-1"},"Cakes",-1))]),e("a",et,[o(P,{class:"w-5 sm:w-6"}),t[6]||(t[6]=e("span",{class:"text-xs mt-1"},"Orders",-1))])])])])}}};export{ht as default};
