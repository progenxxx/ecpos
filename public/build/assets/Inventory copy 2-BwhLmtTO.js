import{k as w,d as c,s as g,l as C,G as I,c as R,w as h,o as N,a as s,e as V,b as p,f as M,j as _,v as D,t as n,n as F,u as k,N as E}from"./app-DfIvzsOQ.js";import{_ as U}from"./Main-CwvSfYt3.js";import{_ as O}from"./MultiSelectDropdown-9gl9kxOO.js";import{T as P}from"./TableContainer-B_NZ86Qn.js";import{P as A,D as q}from"./dataTables-BsbRCurN.js";import"./buttons.print-D4GCgNOs.js";import"./Logout-3bWQyGlF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-CysVaCy0.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-C388c1rV.js";import"./PartyCake143-LtAgi0Q7.js";import"./Attendance-DnkoFQCQ.js";const $={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow"},j={key:0,class:"flex-1 min-w-[200px]"},W={class:"flex-1 min-w-[200px]"},z={class:"flex-1 min-w-[200px]"},G={class:"collapse collapse-plus bg-gray-100 rounded-none"},L={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Y={class:"bg-white p-4 rounded-lg shadow"},H={class:"text-2xl"},J={class:"bg-white p-4 rounded-lg shadow"},K={class:"text-2xl"},Q={class:"bg-white p-4 rounded-lg shadow"},X={class:"text-2xl"},Z={class:"bg-white p-4 rounded-lg shadow"},ee={class:"text-2xl"},te={class:"bg-white p-4 rounded-lg shadow"},se={class:"text-2xl"},ae={class:"bg-white p-4 rounded-lg shadow"},re={class:"text-2xl"},oe={class:"bg-white p-4 rounded-lg shadow"},le={class:"bg-white p-4 rounded-lg shadow"},we={__name:"Inventory copy 2",props:{inventory:{type:Array,required:!0,default:()=>[]},stores:{type:Array,required:!0,default:()=>[]},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(u){A.use(q);const r=u;w(()=>{console.log("Inventory prop:",r.inventory),console.log("Inventory type:",typeof r.inventory),console.log("Is Array:",Array.isArray(r.inventory))});const i=c(r.filters.selectedStores||[]),o=c(r.filters.startDate||""),l=c(r.filters.endDate||""),B=[{data:"itemname",title:"Item Name",className:"min-w-[200px]"},{data:"beginning",title:"Beginning",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"received_delivery",title:"Received Delivery",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"sales",title:"Sales",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"throw_away",title:"Throw Away",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"early_molds",title:"Early Molds",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"pull_out",title:"Pull Out",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"rat_bites",title:"Rat Bites",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"ant_bites",title:"Ant Bites",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"item_count",title:"Item Count",className:"text-right",render:t=>Number(t||0).toFixed(2)},{data:"ending",title:"Ending",className:"text-right font-bold",render:t=>Number(t||0).toFixed(2)},{data:"variance",title:"Variance",className:"text-right",render:(t,e,a)=>{const m=Number(t||0);return`<span class="${m<0?"text-red-600":"text-green-600"}">${m.toFixed(2)}</span>`}}],S={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",buttons:["copy",{extend:"csv",title:"Inventory Report"},{extend:"excel",title:"Inventory Report"},{extend:"pdf",title:"Inventory Report"},"print"]},d=g(()=>!r.inventory||!Array.isArray(r.inventory)?(console.warn("Inventory is not an array:",r.inventory),{beginning:0,receivedDelivery:0,sales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0}):r.inventory.reduce((t,e)=>{const a=f=>Number(f||0),m=a(e.throw_away)+a(e.early_molds)+a(e.pull_out)+a(e.rat_bites)+a(e.ant_bites);return{beginning:t.beginning+a(e.beginning),receivedDelivery:t.receivedDelivery+a(e.received_delivery),sales:t.sales+a(e.sales),waste:t.waste+m,itemcount:t.itemcount+a(e.item_count),ending:t.ending+a(e.ending),variance:t.variance+a(e.variance),throwAway:t.throwAway+a(e.throw_away),earlyMolds:t.earlyMolds+a(e.early_molds),pullOut:t.pullOut+a(e.pull_out),ratBites:t.ratBites+a(e.rat_bites),antBites:t.antBites+a(e.ant_bites)}},{beginning:0,receivedDelivery:0,sales:0,waste:0,itemcount:0,ending:0,variance:0,throwAway:0,earlyMolds:0,pullOut:0,ratBites:0,antBites:0})),x=()=>{if(o.value&&l.value){const t=new Date(o.value),e=new Date(l.value);if(t>e){alert("Start date cannot be later than end date");return}}E.get(route("reports.inventory"),{startDate:o.value,endDate:l.value,stores:i.value},{preserveState:!0,preserveScroll:!0,onError:t=>{console.error("Filter update failed:",t)}})},T=()=>{i.value=[],o.value="",l.value="",x()},y=g(()=>!r.inventory||!Array.isArray(r.inventory)?0:r.inventory.map(t=>Number(t.variance||0)).filter(t=>t<0).reduce((t,e)=>t+e,0)),b=g(()=>!r.inventory||!Array.isArray(r.inventory)?0:r.inventory.map(t=>Number(t.variance||0)).filter(t=>t>0).reduce((t,e)=>t+e,0));let v;return C([i,o,l],()=>{clearTimeout(v),v=setTimeout(x,500)},{deep:!0}),I(()=>{clearTimeout(v)}),w(()=>{i.value=r.filters.selectedStores||[],o.value=r.filters.startDate||"",l.value=r.filters.endDate||""}),(t,e)=>(N(),R(U,{"active-tab":"REPORTS"},{main:h(()=>[s("div",$,[u.userRole.toUpperCase()==="ADMIN"||u.userRole.toUpperCase()==="SUPERADMIN"?(N(),V("div",j,[p(O,{modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),options:u.stores,label:"Stores"},null,8,["modelValue","options"])])):M("",!0),s("div",W,[e[3]||(e[3]=s("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),_(s("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=a=>o.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[D,o.value]])]),s("div",z,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),_(s("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=a=>l.value=a),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[D,l.value]])]),s("div",{class:"flex items-end"},[s("button",{onClick:T,class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),s("details",G,[e[13]||(e[13]=s("summary",{class:"collapse-title text-sm font-medium"},"SUMMARY",-1)),s("div",L,[s("div",Y,[e[5]||(e[5]=s("h3",{class:"text-lg font-semibold"},"Beginning Balance",-1)),s("p",H,n(d.value.beginning.toFixed(2)),1)]),s("div",J,[e[6]||(e[6]=s("h3",{class:"text-lg font-semibold"},"Total Received",-1)),s("p",K,n(d.value.receivedDelivery.toFixed(2)),1)]),s("div",Q,[e[7]||(e[7]=s("h3",{class:"text-lg font-semibold"},"Total Waste",-1)),s("p",X,n(d.value.waste.toFixed(2)),1)]),s("div",Z,[e[8]||(e[8]=s("h3",{class:"text-lg font-semibold"},"Total Sales",-1)),s("p",ee,n(d.value.sales.toFixed(2)),1)]),s("div",te,[e[9]||(e[9]=s("h3",{class:"text-lg font-semibold"},"Total Item Count",-1)),s("p",se,n(d.value.itemcount.toFixed(2)),1)]),s("div",ae,[e[10]||(e[10]=s("h3",{class:"text-lg font-semibold"},"Ending Balance",-1)),s("p",re,n(d.value.ending.toFixed(2)),1)]),s("div",oe,[e[11]||(e[11]=s("h3",{class:"text-lg font-semibold"},"Total Negative Variance",-1)),s("p",{class:F(["text-2xl",y.value<0?"text-red-600":"text-green-600"])},n(y.value.toFixed(2)),3)]),s("div",le,[e[12]||(e[12]=s("h3",{class:"text-lg font-semibold"},"Total Negative Variance",-1)),s("p",{class:F(["text-2xl",b.value>0?"text-red-600":"text-green-600"])},n(b.value.toFixed(2)),3)])])]),p(P,null,{default:h(()=>[p(k(A),{data:u.inventory,columns:B,class:"w-full relative display",options:S},null,8,["data"])]),_:1})]),_:1}))}};export{we as default};
