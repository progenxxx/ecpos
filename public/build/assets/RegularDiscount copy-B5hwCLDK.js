import{d as c,k as E,q as m,l as F,E as N,c as k,w as f,B as U,o as w,a as s,e as A,b as v,f as O,j as D,v as g,u as I,N as V}from"./app-tcDoizJR.js";import{_ as h}from"./AdminPanel-O819wuuc.js";import{_ as q}from"./Main-Dtv15pGL.js";import{_ as B}from"./MultiSelectDropdown-C37twh5x.js";import{T as M}from"./TableContainer-YM_KkEqb.js";import{P as b,D as y}from"./dataTables-CvLdq1lI.js";import"./buttons.print-59nVycpF.js";import"./exceljs.min-DHKwiMMl.js";import"./RetailGroup-CmLptvTZ.js";import"./Logout-yGTYNAB4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-CXwwTKO7.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-yJWX9S4O.js";import"./RetailItems-D0FvWooD.js";import"./Attendance-BwOqMts8.js";import"./PartyCake143-BunxM3QJ.js";const P={class:"mb-4 flex flex-wrap gap-4 p-4 bg-white rounded-lg shadow z-[999]"},L={key:0,class:"flex-1 min-w-[200px]"},$={class:"flex-1 min-w-[200px]"},j={class:"flex-1 min-w-[200px]"},z={class:"flex items-end"},ie={__name:"RegularDiscount copy",props:{rd:{type:Array,required:!0},stores:{type:Array,required:!0},userRole:{type:String,required:!0},filters:{type:Object,required:!0,default:()=>({startDate:"",endDate:"",selectedStores:[]})}},setup(i){b.use(y);const l=c([]),a=c(""),r=c(""),n=i;E(()=>{l.value=n.filters.selectedStores||[],a.value=n.filters.startDate||"",r.value=n.filters.endDate||""});const S=m(()=>(console.log("userRole value:",n.userRole),console.log("Is Store?:",n.userRole.toUpperCase()==="STORE"),n.userRole.toUpperCase()==="STORE"?q:h)),x=m(()=>{let t=[...n.rd];return l.value.length>0&&(t=t.filter(e=>l.value.includes(e.storename))),a.value&&r.value&&(t=t.filter(e=>{const o=new Date(e.createddate),p=new Date(a.value),R=new Date(r.value);return o>=p&&o<=R})),t}),d=m(()=>x.value.reduce((t,e)=>(t.senior_discount+=parseFloat(e.senior_discount||0),t.pwd_discount+=parseFloat(e.pwd_discount||0),t),{senior_discount:0,pwd_discount:0})),T=[{data:"storename",title:"STORE",footer:"GRAND TOTAL"},{data:"receiptid",title:"RECEIPT",footer:""},{data:"itemname",title:"ITEMNAME",footer:""},{data:"createddate",title:"DATE",footer:"",render:function(t,e,o){return new Date(t).toLocaleDateString()}},{data:"senior_discount",title:"SENIOR DISCOUNT",render:t=>parseFloat(t||0).toFixed(2),footer:function(){return d.value.senior_discount.toFixed(2)}},{data:"pwd_discount",title:"PWD DISCOUNT",render:t=>parseFloat(t||0).toFixed(2),footer:function(){return d.value.pwd_discount.toFixed(2)}}],_={responsive:!0,order:[[0,"asc"]],pageLength:25,dom:"Bfrtip",scrollX:!0,scrollY:"50vh",buttons:["copy",{text:"Export Excel",action:function(t,e,o,p){exportToExcel()}},"pdf","print"],order:[[2,"asc"]],drawCallback:function(t){const o=new y.Api(t).table().footer().querySelectorAll("td, th");o[4]&&(o[4].textContent=d.value.senior_discount.toFixed(2)),o[5]&&(o[5].textContent=d.value.pwd_discount.toFixed(2))}},C=()=>{if(a.value&&r.value&&new Date(a.value)>new Date(r.value)){alert("Start date cannot be later than end date"),a.value="",r.value="";return}V.get(route("reports.rd"),{startDate:a.value,endDate:r.value,stores:l.value},{preserveState:!0,preserveScroll:!0})};let u;return F([l,a,r],()=>{clearTimeout(u),u=setTimeout(C,500)},{deep:!0}),N(()=>{clearTimeout(u)}),(t,e)=>(w(),k(U(S.value),{"active-tab":"REPORTS"},{main:f(()=>[s("div",P,[i.userRole.toUpperCase()==="ADMIN"||i.userRole.toUpperCase()==="SUPERADMIN"?(w(),A("div",L,[v(B,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o),options:i.stores,label:"Stores"},null,8,["modelValue","options"])])):O("",!0),s("div",$,[e[4]||(e[4]=s("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),D(s("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=o=>a.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,a.value]])]),s("div",j,[e[5]||(e[5]=s("label",{class:"block text-sm font-medium text-gray-700"},"End Date",-1)),D(s("input",{type:"date","onUpdate:modelValue":e[2]||(e[2]=o=>r.value=o),class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},null,512),[[g,r.value]])]),s("div",z,[s("button",{onClick:e[3]||(e[3]=()=>{l.value=[],a.value="",r.value=""}),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-md"}," Clear Filters ")])]),v(M,null,{default:f(()=>[v(I(b),{data:x.value,columns:T,class:"w-full relative display",options:_},{action:f(o=>e[6]||(e[6]=[])),_:1},8,["data"])]),_:1})]),_:1}))}};export{ie as default};
