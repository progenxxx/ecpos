import{d as g,s as w,e as d,b as u,w as y,u as v,F as h,o as p,a as e,Z as N,z as P,g as Y,t as r,n as m,j as b,x as D,h as F,f as V}from"./app-D4KRJyko.js";import{_ as M}from"./Main-CpodJpc1.js";import{S as j}from"./sweetalert2.esm.all-IRYXxR_Z.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Logout-8hw4reCp.js";/* empty css                                                             */import"./Modal-C1bDdoN8.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-5n6bCmaZ.js";import"./PartyCake143-Cp4Fa7fu.js";import"./Attendance-DvpGN19-.js";const q={class:"container mx-auto px-4 mt-10 sm:px-6 lg:px-8"},z={class:"mb-4 flex justify-between items-center"},E={class:"bg-white shadow rounded-lg p-6 mb-6"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},I={class:"font-medium"},O={class:"font-medium"},R={class:"font-medium"},W={class:"font-medium"},H={class:"font-medium"},Z={class:"bg-white shadow rounded-lg overflow-hidden"},G={class:"p-4 border-b flex flex-col sm:flex-row justify-between items-center gap-4"},J={class:"flex gap-2"},K={class:"overflow-x-auto"},Q={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},ee={class:"px-6 py-4 whitespace-nowrap"},te={class:"px-6 py-4 whitespace-nowrap"},se={class:"px-6 py-4"},ae={class:"px-6 py-4 whitespace-nowrap"},re={key:0},oe={__name:"Show",props:{loyaltyCard:{type:Object,required:!0},transactions:{type:Array,required:!0},maxPointsPerTransaction:{type:Number,default:1e4},storeId:{type:String,required:!0}},setup(n){g(!1);const i=n;j.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0});const l=g({type:"",period:"all"}),_=s=>`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800"}[s]||""}`,C=s=>s==="earn"?"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800":"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",k=s=>({earn:"Earned",redeem:"Redeemed"})[s]||s,T=s=>s?s.charAt(0).toUpperCase()+s.slice(1):"",c=s=>s?new Date(s).toLocaleDateString():"",L=s=>s?new Date(s).toLocaleString():"";w(()=>i.loyaltyCard.is_active&&i.loyaltyCard.points>0);const x=w(()=>{if(!Array.isArray(i.transactions))return console.warn("transactions prop is not an array:",i.transactions),[];let s=[...i.transactions];l.value.type&&(s=s.filter(o=>o.type===l.value.type));const t=new Date,a=new Date(t.getFullYear(),t.getMonth(),t.getDate()),f=new Date(a);f.setDate(a.getDate()-a.getDay());const S=new Date(t.getFullYear(),t.getMonth(),1),A=new Date(t.getFullYear(),0,1);switch(l.value.period){case"today":s=s.filter(o=>new Date(o.created_at)>=a);break;case"week":s=s.filter(o=>new Date(o.created_at)>=f);break;case"month":s=s.filter(o=>new Date(o.created_at)>=S);break;case"year":s=s.filter(o=>new Date(o.created_at)>=A);break}return s.sort((o,B)=>new Date(B.created_at)-new Date(o.created_at))});return(s,t)=>(p(),d(h,null,[u(v(N),{title:"Loyalty Card Details"},{default:y(()=>t[2]||(t[2]=[e("meta",{name:"description",content:"Loyalty Card Details and Transactions"},null,-1)])),_:1}),u(M,{"active-tab":"LOYALTY",user:s.$page.props.auth.user},{main:y(()=>[e("div",q,[e("div",z,[t[4]||(t[4]=e("h1",{class:"text-2xl font-bold"},"Loyalty Card Details",-1)),u(v(P),{href:"/loyalty-cards",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:y(()=>t[3]||(t[3]=[Y(" Back to List ")])),_:1})]),e("div",E,[e("div",$,[e("div",null,[t[5]||(t[5]=e("h3",{class:"text-gray-600"},"Card Number",-1)),e("p",I,r(n.loyaltyCard.card_number),1)]),e("div",null,[t[6]||(t[6]=e("h3",{class:"text-gray-600"},"Customer",-1)),e("p",O,r(n.loyaltyCard.customer.name),1)]),e("div",null,[t[7]||(t[7]=e("h3",{class:"text-gray-600"},"Points",-1)),e("p",R,r(n.loyaltyCard.points_formatted),1)]),e("div",null,[t[8]||(t[8]=e("h3",{class:"text-gray-600"},"Status",-1)),e("span",{class:m(_(n.loyaltyCard.status))},r(T(n.loyaltyCard.status)),3)]),e("div",null,[t[9]||(t[9]=e("h3",{class:"text-gray-600"},"Created At",-1)),e("p",W,r(c(n.loyaltyCard.created_at)),1)]),e("div",null,[t[10]||(t[10]=e("h3",{class:"text-gray-600"},"Last Updated",-1)),e("p",H,r(c(n.loyaltyCard.updated_at)),1)])])]),e("div",Z,[e("div",G,[t[13]||(t[13]=e("h2",{class:"text-xl font-bold"},"Transaction History",-1)),e("div",J,[b(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.type=a),class:"rounded-md border-gray-300 shadow-sm text-sm"},t[11]||(t[11]=[e("option",{value:""},"All Types",-1),e("option",{value:"earn"},"Earned Points",-1),e("option",{value:"redeem"},"Redeemed Points",-1)]),512),[[D,l.value.type]]),b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.period=a),class:"rounded-md border-gray-300 shadow-sm text-sm"},t[12]||(t[12]=[e("option",{value:"all"},"All Time",-1),e("option",{value:"today"},"Today",-1),e("option",{value:"week"},"This Week",-1),e("option",{value:"month"},"This Month",-1),e("option",{value:"year"},"This Year",-1)]),512),[[D,l.value.period]])])]),e("div",K,[e("table",Q,[t[15]||(t[15]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Points"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Description"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Balance")])],-1)),e("tbody",X,[(p(!0),d(h,null,F(x.value,a=>(p(),d("tr",{key:a.id},[e("td",ee,r(L(a.created_at)),1),e("td",te,[e("span",{class:m(C(a.type))},r(k(a.type)),3)]),e("td",{class:m(["px-6 py-4 whitespace-nowrap font-medium",a.type==="redeem"?"text-red-600":"text-green-600"])},r(a.type==="redeem"?"-":"+")+r(a.points_formatted),3),e("td",se,r(a.description),1),e("td",ae,r(a.balance_after_formatted),1)]))),128)),x.value.length===0?(p(),d("tr",re,t[14]||(t[14]=[e("td",{colspan:"5",class:"px-6 py-4 text-center text-gray-500"}," No transactions found for the selected filters ",-1)]))):V("",!0)])])])])])]),_:1},8,["user"])],64))}},fe=U(oe,[["__scopeId","data-v-90d17be9"]]);export{fe as default};
