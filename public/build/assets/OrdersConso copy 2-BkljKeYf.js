import{T as _,d as M,q as b,p as C,c as N,w as g,o as R,b as m,a,i as Y,j as x,v as I,u as p,n as $}from"./app-DIsI2h6N.js";import{_ as L}from"./AdminPanel-4mme3aov.js";import{T as G}from"./TableContainer-BvhjGUIg.js";import{P as D,D as j}from"./dataTables-CYg83-KT.js";import{_ as F}from"./SuccessButton-C3nHCW3W.js";import{_ as V}from"./TransparentButton-DJG8eOOC.js";import{E as B}from"./Excel-upFWTmjf.js";import{S as z}from"./SearchColored-Cbq66vCU.js";import{E as H}from"./exceljs.min-BCSGA5zn.js";import"./RetailGroup-g15s03XT.js";import"./Logout-CSswU4gJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                             */import"./Modal-DKCN2m9N.js";import"./Modal.vue_vue_type_style_index_0_scoped_fd08cd24_lang-BHRlHpU4.js";import"./RetailItems-BxtVv693.js";const U={class:"absolute adjust"},q={class:"flex justify-start items-center"},P=["value"],W={"date-rangepicker":"",class:"flex items-center"},J={class:"relative ml-5"},X=["placeholder"],K={class:"relative"},Q=["placeholder"],Z={props:{orders:{type:Array,required:!0}},computed:{flattenedOrders(){return this.calculateFlattenedOrders(this.orders)}},methods:{async exportToExcel(){try{const u=new H.Workbook,f=u.addWorksheet("Flattened Orders"),o=[{header:"ITEMID",key:"ITEMID",width:20},{header:"ITEMNAME",key:"ITEMNAME",width:25},{header:"CATEGORY",key:"CATEGORY",width:20},{header:"TOTAL",key:"TOTAL",width:15}],r=new Set;this.flattenedOrders.forEach(l=>{Object.keys(l).forEach(d=>{d!=="ITEMID"&&d!=="ITEMNAME"&&d!=="CATEGORY"&&d!=="TOTAL"&&r.add(d)})}),r.forEach(l=>{o.push({header:l,key:l,width:15})}),f.columns=o,this.flattenedOrders.forEach(l=>{const d={ITEMID:l.ITEMID,ITEMNAME:l.ITEMNAME,CATEGORY:l.CATEGORY,TOTAL:l.TOTAL};r.forEach(h=>{d[h]=l[h]||0}),f.addRow(d)});const n=new Date,c=`FlattenedOrders_${n.getFullYear()}-${n.getMonth()+1}-${n.getDate()}.xlsx`,E=await u.xlsx.writeBuffer();this.saveExcelFile(E,c)}catch(u){console.error("Error exporting to Excel:",u)}},saveExcelFile(u,f){const o=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=document.createElement("a");r.href=URL.createObjectURL(o),r.download=f,r.click()},calculateFlattenedOrders(u){const f=u.reduce((o,r)=>{const n=r.STORENAME,c=r.ITEMNAME,E=r.ITEMID,l=r.CATEGORY,d=parseInt(r.COUNTED.trim())||0;return o[c]||(o[c]={ITEMID:E,ITEMNAME:c,CATEGORY:l}),o[c][n]||(o[c][n]=0),o[c][n]+=d,o},{});return Object.values(f).map(o=>{let r=0;return Object.keys(o).forEach(n=>{n!=="ITEMID"&&n!=="ITEMNAME"&&n!=="CATEGORY"&&(r+=o[n])}),{...o,TOTAL:r}})}}},he=Object.assign(Z,{__name:"OrdersConso copy 2",props:{orders:{type:Array,required:!0}},setup(u,{emit:f}){D.use(j);const o=u,r=_({StartDate:"",EndDate:""}),n=()=>{r.get(route("orderingconso.getrange"),{preserveScroll:!0})},c={paging:!1,scrollX:!0,scrollY:"60vh",scrollCollapse:!0,error:function(t,e,i){console.error("DataTables error:",e)}},E=o.orders.reduce((t,e)=>{const{STORENAME:i,ITEMID:s,ITEMNAME:A,CATEGORY:k,COUNTED:S}=e,y=parseInt(S.trim(),10)||0;return t[s]||(t[s]={ITEMID:s,ITEMNAME:A,CATEGORY:k,TOTAL:0}),t[s][i]||(t[s][i]=0),t[s][i]+=y,t[s].TOTAL+=y,t},{}),l=Object.values(E),d=[{title:"ITEMID",data:"ITEMID"},{title:"ITEMS",data:"ITEMNAME"},{title:"CATEGORY",data:"CATEGORY"},{title:"TOTAL",data:"TOTAL"}],h=new Set;l.forEach(t=>{Object.keys(t).forEach(e=>{e!=="ITEMID"&&e!=="ITEMNAME"&&e!=="CATEGORY"&&e!=="TOTAL"&&h.add(e)})}),h.forEach(t=>{d.push({title:t,data:t})}),l.forEach(t=>{d.forEach(e=>{t.hasOwnProperty(e.data)||(t[e.data]="0")})});const w=M(null),T=b(()=>{if(w.value){const t=new Date(w.value),e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${i}-${s}`}return""}),O=M(null),v=b(()=>{if(O.value){const t=new Date(O.value),e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}-${i}-${s}`}return""});return b(()=>{const t=new Date,e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${e}${i}${s}`}),(t,e)=>{const i=C("InputError");return R(),N(L,{"active-tab":"REPORTS"},{main:g(()=>[m(G,null,{default:g(()=>[a("div",U,[a("div",q,[a("form",{onSubmit:Y(n,["prevent"]),class:"px-2 py-3 max-h-[50vh] lg:max-h-[70vh] overflow-y-auto"},[a("input",{type:"hidden",name:"_token",value:t.$page.props.csrf_token},null,8,P),a("div",W,[a("div",J,[e[4]||(e[4]=a("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[a("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),x(a("input",{id:"StartDate",type:"date","onUpdate:modelValue":e[0]||(e[0]=s=>p(r).StartDate=s),onInput:e[1]||(e[1]=(...s)=>T.value&&T.value(...s)),placeholder:T.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,X),[[I,p(r).StartDate]]),m(i,{message:p(r).errors.StartDate,class:"mt-2"},null,8,["message"])]),e[6]||(e[6]=a("span",{class:"mx-4 text-gray-500"},"to",-1)),a("div",K,[e[5]||(e[5]=a("div",{class:"flex absolute inset-y-0 left-0 items-center pl-3 pointer-events-none"},[a("svg",{class:"w-5 h-5 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z","clip-rule":"evenodd"})])],-1)),x(a("input",{id:"EndDate",type:"date","onUpdate:modelValue":e[2]||(e[2]=s=>p(r).EndDate=s),onInput:e[3]||(e[3]=(...s)=>v.value&&v.value(...s)),placeholder:v.value,class:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",required:""},null,40,Q),[[I,p(r).EndDate]]),m(i,{message:p(r).errors.EndDate,class:"mt-2"},null,8,["message"])])])],32),m(V,{type:"submit",onClick:n,disabled:p(r).processing,class:$({"opacity-25":p(r).processing})},{default:g(()=>[m(z,{class:"h-8"})]),_:1},8,["disabled","class"]),e[7]||(e[7]=a("details",{className:"dropdown"},[a("summary",{className:"btn m-1"},"RECENT"),a("ul",{className:"menu dropdown-content bg-base-100 rounded-box z-[1] w-52 p-2 shadow"},[a("li",null,[a("a",{href:"/lastmonth"},"Last Month")]),a("li",null,[a("a",{href:"/lastweek"},"Last Week")]),a("li",null,[a("a",{href:"/yesterday"},"Yesterday")])])],-1)),m(F,{type:"button",onClick:t.exportToExcel,class:"m-6 bg-green"},{default:g(()=>[m(B,{class:"h-4"})]),_:1},8,["onClick"])])]),m(p(D),{data:p(l),columns:d,class:"w-full relative display",options:c},{action:g(s=>e[8]||(e[8]=[a("div",{class:"flex justify-start"},null,-1)])),_:1},8,["data"])]),_:1})]),_:1})}}});export{he as default};
